<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="7/22/2014 2:43:54 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="MSANTOS_DEV"
  DTS:CreatorName="HAYESSOFT\mkallen"
  DTS:DTSID="{D0ECBC90-79FD-49F2-A94E-860174C7EB7A}"
  DTS:EnableConfig="True"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="14.0.0800.90"
  DTS:LocaleID="1033"
  DTS:ObjectName="Northside_TipWebImport"
  DTS:PackageType="5"
  DTS:VersionBuild="235"
  DTS:VersionGUID="{155732F8-223C-4705-9BF4-93EF76702853}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[DBConn]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
      DTS:ObjectName="DBConn">
      <DTS:PropertyExpression
        DTS:Name="InitialCatalog">@[User::dataDepotDatabase]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="ServerName">@[User::dataDepotServer]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=CSS-NBLAKELY\MSSQLSERVER2014;Initial Catalog=TipWeb_Northside_0822;Provider=SQLNCLI11.1;Integrated Security=SSPI;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E5623B75-0784-47F6-B86E-5911155CF094}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[$Project::ClientDB]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="dataDepotDatabase">
      <DTS:VariableValue
        DTS:DataType="8">TipWeb_Northside_0822</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{6254593A-20E0-4ABB-BD6D-EF7570FF8BB4}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[$Project::Server]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="dataDepotServer">
      <DTS:VariableValue
        DTS:DataType="8">CSS-NBLAKELY\MSSQLSERVER2014</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\00 -Default Room &amp; ETL Items - Opt 4, 19, &amp; 20"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{92384C54-A2C0-4229-8918-FC67241BD181}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="00 -Default Room &amp; ETL Items - Opt 4, 19, &amp; 20"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="&#x9;--00&#xA;&#x9;SET NOCOUNT ON;&#xA;&#x9;-- verify that settings are present&#xA;&#x9;IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 4) &lt;&gt; 1&#xA;&#x9;&#x9;BEGIN&#xA;&#x9;&#x9;&#x9;INSERT INTO [dbo].[_ETL_Settings] ([ETLSettingUID], [ETLSettingName], [ETLSettingValue])&#xA;&#x9;&#x9;&#x9;VALUES (NULL, NULL, NULL)&#xA;&#x9;&#x9;END&#xA;&#x9;&#xA;&#x9;-- verify that there is a default room in the table (for every site)&#xA;&#x9;DECLARE @DEFAULT_ROOM VARCHAR(50)&#xA;&#x9;DECLARE @ROOMTYPEUID INT&#xA;&#xA;&#x9;SET @DEFAULT_ROOM = (SELECT ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 4)&#xA;&#xA;&#x9;IF (SELECT COUNT(*) FROM tblUnvRoomTypes WHERE RoomTypeName = @DEFAULT_ROOM) = 0&#xA;&#x9;&#x9;INSERT INTO tblUnvRoomTypes (RoomTypeName, RoomTypeDescription,&#xA;&#x9;&#x9;CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#x9;&#x9;SELECT @DEFAULT_ROOM, @DEFAULT_ROOM, 0, GETDATE(), 0, GETDATE()&#xA;&#xA;&#x9;SET @ROOMTYPEUID = (SELECT RoomTypeUID FROM tblUnvRoomTypes WHERE RoomTypeName = @DEFAULT_ROOM)&#xA;&#xA;&#x9;INSERT INTO tblUnvRooms (RoomNumber, RoomDescription, RoomTypeUID, RoomNotes, SiteUID, Active,&#xA;&#x9;CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#x9;SELECT @DEFAULT_ROOM, @DEFAULT_ROOM, @ROOMTYPEUID, 'Default Room for Imported Inventory',&#xA;&#x9;Sites.SiteUID, 1, 0, GETDATE(), 0, GETDATE()&#xA;&#x9;FROM tblTechSites AS Sites&#xA;&#x9;LEFT JOIN tblUnvRooms AS Rooms ON Sites.SiteUID = Rooms.SiteUID&#xA;&#x9;AND Rooms.RoomNumber = @DEFAULT_ROOM&#xA;&#x9;WHERE Rooms.RoomUID IS NULL&#xA;&#xA;&#x9;Truncate table _ETL_Items&#xA;&#xA;&#x9;IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 20 AND ETLSettingValue = 'True') = 1  --Products from Inventory; evals true&#xA;&#x9;&#x9;BEGIN&#xA;&#x9;&#x9;&#x9;INSERT INTO _ETL_Items (ProductName, ProductType, Model, Manufacturer, Area)&#xA;&#x9;&#x9;&#x9;SELECT Inventory.Product, Inventory.ProductType, Inventory.Model, Inventory.Manufacturer, Inventory.Area&#xA;&#x9;&#x9;&#x9;FROM _ETL_Inventory AS Inventory&#xA;&#x9;&#x9;&#x9;LEFT JOIN _ETL_Items AS Items&#xA;&#x9;&#x9;&#x9;ON UPPER(ISNULL(Inventory.Product, '')) = UPPER(ISNULL(Items.ProductName, ''))&#xA;&#x9;&#x9;&#x9;AND UPPER(ISNULL(Inventory.Model, '')) = UPPER(ISNULL(Items.Model, ''))&#xA;&#x9;&#x9;&#x9;AND UPPER(ISNULL(Inventory.Manufacturer, '')) = UPPER(ISNULL(Items.Manufacturer, ''))&#xA;&#x9;&#x9;&#x9;AND UPPER(ISNULL(Inventory.Area, '')) = UPPER(ISNULL(Items.Area, ''))&#xA;&#x9;&#x9;&#x9;WHERE Items.ETLItemUID IS NULL&#xA;&#x9;&#x9;&#x9;GROUP BY Inventory.Product, Inventory.ProductType, Inventory.Model, Inventory.Manufacturer, Inventory.Area&#xA;&#xA;&#x9;&#x9;&#x9;--select ttm.ItemUID, ItemName, ItemTypeName, ModelNumber, ManufacturerName&#xA;&#x9;&#x9;&#x9;update etl set ItemUID = ttm.ItemUID, ItemTypeUID = ttm.ItemTypeUID, ManufacturerUID = ttm.ManufacturerUID&#xA;&#x9;&#x9;&#x9;from tblTechItems ttm&#xA;&#x9;&#x9;&#x9;join tblTechItemTypes tty on ttm.ItemTypeUID = tty.ItemTypeUID&#xA;&#x9;&#x9;&#x9;join tblUnvManufacturers tman on ttm.ManufacturerUID = tman.ManufacturerUID&#xA;&#x9;&#x9;&#x9;join _ETL_Items etl on&#x9;ItemName = ProductName &#xA;&#x9;&#x9;&#x9;&#x9;and ItemTypeName = ProductType &#xA;&#x9;&#x9;&#x9;&#x9;and ttm.ModelNumber = etl.Model &#xA;&#x9;&#x9;&#x9;&#x9;and tman.ManufacturerName = etl.Manufacturer&#xA;&#x9;&#x9;&#x9;where ttm.ItemUID &gt; 0&#xA;&#x9;&#x9;&#x9;and etl.ItemUID is null&#xA;&#x9;&#x9;END" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\01 -Manufacturers"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{BAB1F8C5-A392-4244-B2BC-1667A092E4C4}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="01 -Manufacturers"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="--01&#xA;&#xA;SET NOCOUNT ON;&#xA;&#x9;IF (SELECT COUNT(*) FROM tblUnvManufacturers WHERE ManufacturerUID = 0) = 0  --evals 0&#xA;&#x9;&#x9;BEGIN&#xA;&#x9;&#x9;&#x9;set Identity_Insert tblUnvManufacturers on &#xA;&#x9;&#x9;&#x9;INSERT INTO tblUnvManufacturers (ManufacturerUID, ManufacturerName, CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#x9;&#x9;&#x9;VALUES (0, 'None', 0, GETDATE(), 0, GETDATE())&#xA;&#x9;&#x9;&#x9;set Identity_Insert tblUnvManufacturers oFF&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;END&#xA;&#xA;&#x9;update _ETL_Items set Manufacturer = 'None'&#x9;where isNull(Manufacturer, '') in ('UNKNOWN','NONE', 'N/A', '')&#xA;&#xA;&#x9;update _ETL_Inventory set Manufacturer = 'None'&#x9;where isNull(Manufacturer, '') in ('UNKNOWN','NONE', 'N/A', '')&#xA;&#xA;&#xA;&#x9;INSERT INTO tblUnvManufacturers (ManufacturerName,&#xA;&#x9;CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#x9;SELECT Items.Manufacturer, 0, GETDATE(), 0, GETDATE()&#xA;&#x9;FROM _ETL_Items AS Items&#xA;&#x9;LEFT JOIN tblUnvManufacturers ON UPPER(Items.Manufacturer) = UPPER(tblUnvManufacturers.ManufacturerName)&#xA;&#x9;where tblUnvManufacturers.ManufacturerUID is null&#xA;&#x9;GROUP BY Items.Manufacturer&#xA;&#xA;&#x9;UPDATE _ETL_Items&#xA;&#x9;SET ManufacturerUID = tblUnvManufacturers.ManufacturerUID&#xA;&#x9;FROM _ETL_Items AS Items&#xA;&#x9;JOIN tblUnvManufacturers ON UPPER(Items.Manufacturer) = UPPER(tblUnvManufacturers.ManufacturerName)&#xA;&#x9;WHERE (Items.ManufacturerUID IS NULL &#x9;OR Items.ManufacturerUID &lt;&gt; tblUnvManufacturers.ManufacturerUID)&#xA;&#xA;&#xA;&#x9;UPDATE _ETL_Items&#xA;&#x9;SET ManufacturerUID = 0&#xA;&#x9;WHERE ManufacturerUID IS NULL" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\02 - Areas"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{60A1997F-E0CC-4023-B6CD-4FB0D6C4749D}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="02 - Areas"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="SET NOCOUNT ON;&#xA;&#x9;IF (SELECT COUNT(*) FROM tblUnvAreas WHERE AreaUID = 0) = 0&#xA;&#x9;&#x9;BEGIN&#xA;&#x9;&#x9;&#x9;SET IDENTITY_INSERT tblUnvAreas ON &#xA;&#x9;&#x9;&#x9;INSERT INTO tblUnvAreas (AreaUID, AreaName,&#xA;&#x9;&#x9;&#x9;CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#x9;&#x9;&#x9;VALUES (0, 'NONE', 0, GETDATE(), 0, GETDATE())&#xA;&#x9;&#x9;&#x9;SET IDENTITY_INSERT tblUnvAreas OFF&#xA;&#x9;&#x9;END&#xA;&#xA;&#x9;INSERT INTO tblUnvAreas (AreaName,&#xA;&#x9;CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#x9;SELECT Items.Area, 0, GETDATE(), 0, GETDATE()&#xA;&#x9;FROM _ETL_Items AS Items&#xA;&#x9;LEFT JOIN tblUnvAreas ON UPPER(Items.Area) = UPPER(tblUnvAreas.AreaName)&#xA;&#x9;WHERE Items.Area IS NOT NULL AND Items.Area &lt;&gt; ''&#xA;&#x9;AND Items.Area &lt;&gt; 'N/A' AND Items.Area &lt;&gt; 'NONE' AND Items.Area &lt;&gt; 'UNKNOWN'&#xA;&#x9;AND tblUnvAreas.AreaUID IS NULL&#xA;&#x9;GROUP BY Items.Area&#xA;&#xA;&#x9;UPDATE _ETL_Items&#xA;&#x9;SET AreaUID = tblUnvAreas.AreaUID&#xA;&#x9;FROM _ETL_Items AS Items&#xA;&#x9;JOIN tblUnvAreas ON UPPER(Items.Area) = UPPER(tblUnvAreas.AreaName)&#xA;&#x9;WHERE Items.Area IS NOT NULL AND Items.Area &lt;&gt; ''&#xA;&#x9;AND Items.Area &lt;&gt; 'N/A' AND Items.Area &lt;&gt; 'NONE' AND Items.Area &lt;&gt; 'UNKNOWN'&#xA;&#x9;AND (Items.AreaUID IS NULL&#xA;&#x9;OR Items.AreaUID &lt;&gt; tblUnvAreas.AreaUID)&#xA;&#xA;&#x9;UPDATE _ETL_Items&#xA;&#x9;SET AreaUID = 0&#xA;&#x9;WHERE AreaUID IS NULL" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\03 - Item Types"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{846F7AE4-0284-4D30-BE39-9DD2BB6C1D82}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="03 - Item Types"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="--03&#xA;SET NOCOUNT ON;&#xA;&#x9;IF (SELECT COUNT(*) FROM tblTechItemTypes WHERE ItemTypeUID = 0) = 0 --evals false&#xA;&#x9;&#x9;BEGIN&#xA;&#x9;&#x9;&#x9;SET IDENTITY_INSERT tblTechItemTypes ON &#xA;&#x9;&#x9;&#x9;INSERT INTO tblTechItemTypes (ItemTypeUID, ItemTypeName, ItemTypeDescription,&#xA;&#x9;&#x9;&#x9;CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#x9;&#x9;&#x9;VALUES (0, 'NONE', NULL, 0, GETDATE(), 0, GETDATE())&#xA;&#x9;&#x9;&#x9;SET IDENTITY_INSERT tblTechItemTypes OFF&#xA;&#x9;&#x9;END&#xA;&#xA;&#x9;UPDATE _ETL_Items&#xA;&#x9;SET ProductTypeDescription = ''&#xA;&#x9;WHERE ProductTypeDescription IS NULL&#xA;&#x9;OR ProductTypeDescription = 'NONE'&#xA;&#x9;OR ProductTypeDescription = 'N/A'&#xA;&#x9;OR ProductTypeDescription = 'UNKNOWN'&#xA;&#x9;GO&#xA;&#xA;&#x9;INSERT INTO tblTechItemTypes (ItemTypeName, ItemTypeDescription,&#xA;&#x9;CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#x9;SELECT etl.ProductType, etl.ProductType,&#xA;&#x9;0, GETDATE(), 0, GETDATE()&#xA;&#x9;FROM _ETL_Inventory AS etl&#xA;&#x9;LEFT JOIN tblTechItemTypes tty ON UPPER(etl.ProductType) = UPPER(tty.ItemTypeName)&#xA;&#x9;where tty.ItemTypeUID is null&#xA;&#x9;GROUP BY etl.ProductType&#xA;&#x9;GO&#xA;&#xA;&#x9;UPDATE _ETL_Items&#xA;&#x9;SET ItemTypeUID = tblTechItemTypes.ItemTypeUID&#xA;&#x9;FROM _ETL_Items AS Items&#xA;&#x9;JOIN tblTechItemTypes ON UPPER(Items.ProductType) = UPPER(tblTechItemTypes.ItemTypeName)&#xA;&#x9;WHERE Items.ProductType IS NOT NULL AND Items.ProductType &lt;&gt; ''&#xA;&#x9;AND Items.ProductType &lt;&gt; 'N/A' AND Items.ProductType &lt;&gt; 'NONE' AND Items.ProductType &lt;&gt; 'UNKNOWN'&#xA;&#x9;AND (Items.ItemTypeUID IS NULL&#xA;&#x9;OR Items.ItemTypeUID &lt;&gt; tblTechItemTypes.ItemTypeUID)&#xA;&#x9;GO&#xA;&#xA;&#xA;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;SET ItemTypeUID = eItem.ItemTypeUID&#xA;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;JOIN _ETL_Items eItem ON  UPPER(Tags.ProductType) = UPPER(eItem.ProductType)&#xA;&#x9;WHERE Tags.ItemTypeUID IS NULL&#xA;&#x9;OR (Tags.ItemTypeUID &lt;&gt; eItem.ItemTypeUID)&#xA;&#x9;GO&#xA;&#xA;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;SET ItemTypeUID = 0&#xA;&#x9;WHERE ItemTypeUID IS NULL&#xA;&#x9;GO&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\04 - Items - Opt 1 &amp; 2"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{B568BC28-977D-46D3-8B6C-C0088ECE4497}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="04 - Items - Opt 1 &amp; 2"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="--04&#xA;&#xA;&#x9;SET NOCOUNT OFF&#xA;&#x9;UPDATE _ETL_Items&#xA;&#x9;SET Model = ''&#xA;&#x9;WHERE Model IS NULL&#xA;&#x9;OR Model = 'N/A'&#xA;&#x9;OR Model = 'NONE'&#xA;&#x9;OR Model = 'UNKNOWN'&#xA;&#xA;&#xA;&#x9;&#x9;DECLARE @PRODNUM AS INT&#xA;&#x9;&#x9;DECLARE @COUNT AS INT&#xA;&#x9;&#x9;SELECT @PRODNUM = Value - 1 FROM tblUnvCounter WHERE CounterUID = 4&#xA;&#xA;&#x9;&#x9;INSERT INTO tblTechItems (ItemNumber, &#xA;&#x9;&#x9;ItemName, ItemDescription, ItemTypeUID, &#xA;&#x9;&#x9;ModelNumber, ManufacturerUID, ItemSuggestedPrice, AreaUID, &#xA;&#x9;&#x9;ItemNotes, &#xA;&#x9;&#x9;SKU, SerialRequired, ProjectedLife, Active, &#xA;&#x9;&#x9;CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#xA;&#xA;&#x9;&#x9;select CONVERT(NVARCHAR, ROW_NUMBER() OVER(ORDER BY etl.Product, etl.Model) + @PRODNUM),&#xA;&#x9;&#x9;Product, ProductDescription, ItemTypeUID, &#xA;&#x9;&#x9;Model, max(ManufacturerUID), 0, 0,&#xA;&#x9;&#x9;'INTG CATALOG DATA IMPORT ' + CONVERT(NVARCHAR(10), GETDATE(), 120),&#xA;&#x9;&#x9;'', 0, 0, 1, &#xA;&#x9;&#x9;0, GETDATE(), 0, GETDATE()&#xA;&#x9;&#x9;from _ETL_Inventory etl&#xA;&#x9;&#x9;join tblUnvManufacturers tman on tman.ManufacturerName = etl.Manufacturer &#xA;&#x9;&#x9;left outer join (&#xA;&#x9;&#x9;&#x9;select distinct itemuid, itemname, modelnumber, ItemTypeName, ManufacturerName&#xA;&#x9;&#x9;&#x9;from tblTechItems ttm&#xA;&#x9;&#x9;&#x9;join tblTechItemTypes tty on ttm.ItemTypeUID = tty.ItemTypeUID&#xA;&#x9;&#x9;&#x9;join tblUnvManufacturers tman on ttm.ManufacturerUID = tman.ManufacturerUID&#xA;&#x9;&#x9;&#x9;) cat&#xA;&#x9;&#x9;&#x9;on etl.Product = cat.ItemName and etl.ProductType = cat.ItemTypeName&#xA;&#x9;&#x9;&#x9;&#x9;and isNull(etl.Model, '') = isNull(cat.ModelNumber, '') and etl.Manufacturer = cat.ManufacturerName&#xA;&#x9;&#x9;where cat.ItemUID is null&#xA;&#x9;&#x9;group by Product, ProductDescription, ItemTypeUID, Model&#xA;&#xA;&#x9;&#x9;SELECT @COUNT = @@ROWCOUNT&#xA;&#x9;&#x9;SELECT @PRODNUM = @PRODNUM + @COUNT&#xA;&#x9;&#x9;IF @COUNT &gt; 0&#xA;&#x9;&#x9;&#x9;BEGIN&#xA;&#x9;&#x9;&#x9;&#x9;UPDATE tblUnvCounter SET Value = @PRODNUM + 1 WHERE CounterUID = 4&#xA;&#x9;&#x9;&#x9;END&#xA;&#xA;&#x9;&#x9;GO&#xA;&#x9;&#x9;UPDATE etl&#xA;&#x9;&#x9;SET ItemUID = cat.ItemUID&#xA;&#x9;&#x9;from _ETL_Inventory etl&#xA;&#x9;&#x9;join tblUnvManufacturers tman on tman.ManufacturerName = etl.Manufacturer &#xA;&#x9;&#x9;left outer join (&#xA;&#x9;&#x9;&#x9;select distinct itemuid, itemname, modelnumber, ItemTypeName, ManufacturerName&#xA;&#x9;&#x9;&#x9;from tblTechItems ttm&#xA;&#x9;&#x9;&#x9;join tblTechItemTypes tty on ttm.ItemTypeUID = tty.ItemTypeUID&#xA;&#x9;&#x9;&#x9;join tblUnvManufacturers tman on ttm.ManufacturerUID = tman.ManufacturerUID&#xA;&#x9;&#x9;&#x9;) cat&#xA;&#x9;&#x9;on etl.Product = cat.ItemName and etl.ProductType = cat.ItemTypeName&#xA;&#x9;&#x9;and isNull(etl.Model, '') = isNull(cat.ModelNumber, '') and etl.Manufacturer = cat.ManufacturerName&#xA;&#x9;&#x9;GO&#xA;&#x9;&#x9;&#xA;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;SET ItemUID = 0 &#xA;&#x9;WHERE ItemUID IS NULL&#xA;&#x9;GO&#xA;&#xA;&#x9;--IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 1 AND ETLSettingValue = 'ProductNumber') = 0  --evals true&#xA;&#x9;--&#x9;BEGIN&#xA;&#x9;--&#x9;&#x9;UPDATE _ETL_Items&#xA;&#x9;--&#x9;&#x9;SET Product = ProductName&#xA;&#x9;--&#x9;END&#xA;&#x9;--ELSE&#xA;&#x9;--&#x9;BEGIN&#xA;&#x9;--&#x9;&#x9;UPDATE _ETL_Items&#xA;&#x9;--&#x9;&#x9;SET Product = ProductNumber&#xA;&#x9;--&#x9;END&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\05 -Populate _ETL_Purchases"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{BEB06141-DDE8-4465-A3A7-0501C63B176A}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="05 -Populate _ETL_Purchases"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="  ----05&#xA;   SET NOCOUNT ON;&#xA;&#xA;&#x9;truncate table _ETL_Purchases &#xA;&#xA;&#x9;Insert _ETL_Purchases &#xA;&#x9;(PurchaseOrder, PurchaseDate, Vendor)&#xA;&#x9;select &#xA;&#x9;PurchaseOrder, max(PurchaseDate), Vendor&#xA;&#x9;from _ETL_Inventory&#xA;&#x9;group by PurchaseOrder, Vendor&#xA;&#x9;order by PurchaseOrder&#xA;&#xA;&#xA;    UPDATE _ETL_Purchases&#xA;    SET PurchaseUID = tpur.PurchaseUID,&#xA;    PurchaseDate = tpur.PurchaseDate, SiteUID = tpur.SiteUID,&#xA;&#x9;VendorUID = tpur.VendorUID&#xA;    FROM _ETL_Purchases AS Purchases&#xA;    JOIN tblTechPurchases tpur ON UPPER(Purchases.PurchaseOrder) = UPPER(tpur.OrderNumber)&#xA;    WHERE Purchases.PurchaseUID IS NULL&#xA;&#xA;    UPDATE _ETL_Purchases&#xA;    SET SiteUID = 1&#xA;    WHERE SiteUID IS NULL&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\06 -Purchase Vendors"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{53433D8E-8DB5-4395-99B4-A6037756EF99}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="06 -Purchase Vendors"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource=" --06&#xA; &#xA;&#x9;SET NOCOUNT ON;&#xA;&#xA;&#x9;UPDATE _ETL_Purchases&#xA;&#x9;SET VendorUID = tblVendor.VendorID&#xA;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;JOIN tblVendor ON UPPER(Purchases.Vendor) = UPPER(tblVendor.VendorName)&#xA;&#x9;AND tblVendor.ApplicationUID = 2&#xA;&#x9;WHERE Purchases.Vendor IS NOT NULL AND Purchases.Vendor &lt;&gt; ''&#xA;&#x9;AND Purchases.Vendor not in ('N/A', 'NONE', 'UNKNOWN')&#xA;&#x9;AND (Purchases.VendorUID IS NULL)&#xA;&#xA;&#xA;&#x9;INSERT INTO tblVendor (VendorName, Active, UserID, ModifiedDate, ApplicationUID,  Notes )&#xA;&#x9;SELECT Purchases.Vendor, 1, 0, GETDATE(), 2,&#xA;&#x9;'INTG DATA IMPORT ' + CONVERT(NVARCHAR(10), GETDATE(), 120) &#xA;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;LEFT JOIN tblVendor ON UPPER(Purchases.Vendor) = UPPER(tblVendor.VendorName)&#xA;&#x9;AND tblVendor.ApplicationUID = 2&#xA;&#x9;WHERE Purchases.Vendor IS NOT NULL AND Purchases.Vendor &lt;&gt; ''&#xA;&#x9;AND Purchases.Vendor not in ('N/A', 'NONE', 'UNKNOWN')&#xA;&#x9;AND tblVendor.VendorID IS NULL&#xA;&#x9;GROUP BY Purchases.Vendor&#xA;&#xA;&#x9;UPDATE _ETL_Purchases&#xA;&#x9;SET VendorUID = tblVendor.VendorID&#xA;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;JOIN tblVendor ON UPPER(Purchases.Vendor) = UPPER(tblVendor.VendorName)&#xA;&#x9;AND tblVendor.ApplicationUID = 2&#xA;&#x9;WHERE Purchases.Vendor IS NOT NULL AND Purchases.Vendor &lt;&gt; ''&#xA;&#x9;AND Purchases.Vendor not in ('N/A', 'NONE', 'UNKNOWN')&#xA;&#x9;AND (Purchases.VendorUID IS NULL)&#xA;&#xA;&#xA;    UPDATE _ETL_Purchases&#xA;    SET VendorUID = 0&#xA;    WHERE VendorUID IS NULL&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\07 -Purchase &amp; Inventory Funding Sources -"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{B90437B3-27B5-4F00-969C-2C7D47A9832B}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="07 -Purchase &amp; Inventory Funding Sources -"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="   --07&#xA;&#xA;    UPDATE etl&#xA;    SET FundingSourceUID = tblFundingSources.FundingSourceUID&#xA;    FROM _ETL_Inventory AS etl&#xA;    JOIN tblFundingSources ON UPPER(etl.FundingSource) = UPPER(tblFundingSources.FundingSource)&#xA;    AND tblFundingSources.ApplicationUID = 2&#xA;    WHERE etl.FundingSource IS NOT NULL AND etl.FundingSource &lt;&gt; ''&#xA;    AND etl.FundingSource not in ('N/A', 'NONE', 'UNKNOWN')&#xA;    AND (etl.FundingSourceUID IS NULL&#xA;    OR etl.FundingSourceUID &lt;&gt; tblFundingSources.FundingSourceUID)&#xA;   &#xA;&#xA;    INSERT INTO tblFundingSources &#xA;&#x9;&#x9;(FundingSource, FundingDesc, Active, ApplicationUID)&#xA;    SELECT etl.FundingSource, MAX(ISNULL(etl.FundingSourceDescription, '')), 1, 2&#xA;    FROM _ETL_Inventory AS etl&#xA;    LEFT JOIN tblFundingSources ON UPPER(etl.FundingSource) = UPPER(tblFundingSources.FundingSource)&#xA;    AND tblFundingSources.ApplicationUID = 2&#xA;    WHERE etl.FundingSource IS NOT NULL AND etl.FundingSource &lt;&gt; ''&#xA;    AND etl.FundingSource not in ('N/A', 'NONE', 'UNKNOWN')&#xA;    AND tblFundingSources.FundingSourceUID IS NULL&#xA;    GROUP BY etl.FundingSource&#xA;&#xA;    UPDATE etl&#xA;    SET FundingSourceUID = tblFundingSources.FundingSourceUID&#xA;    FROM _ETL_Inventory AS etl&#xA;    JOIN tblFundingSources ON UPPER(etl.FundingSource) = UPPER(tblFundingSources.FundingSource)&#xA;    AND tblFundingSources.ApplicationUID = 2&#xA;    WHERE etl.FundingSource IS NOT NULL AND etl.FundingSource &lt;&gt; ''&#xA;    AND etl.FundingSource not in ('N/A', 'NONE', 'UNKNOWN')&#xA;    AND (etl.FundingSourceUID IS NULL)&#xA;&#xA;    UPDATE _ETL_Purchases&#xA;    SET FundingSourceUID = 0&#xA;    WHERE FundingSourceUID IS NULL&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\08 -Create Purchase Orders Update ETL Purchases"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{1952BEDB-48A6-403E-A60A-55AD41D7AA0E}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="08 -Create Purchase Orders Update ETL Purchases"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="--08&#xA;&#xA;&#xA;&#xA;&#xA;    INSERT INTO tblTechPurchases (StatusUID, VendorUID, SiteUID, OrderNumber, PurchaseDate, &#xA;&#x9;Notes, &#xA;&#x9;CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#xA;    SELECT 32, MAX(ePur.VendorUID), MIN(ePur.SiteUID), ePur.PurchaseOrder, min(ePur.PUrchaseDate),&#xA;    'INTEGRATION IMPORT ' + CONVERT(NVARCHAR(10), GETDATE(), 120),&#xA;    0, GETDATE(), 0, GETDATE()&#xA;    FROM _ETL_Purchases AS ePur&#xA;&#x9;join _ETL_Inventory as eInv on ePur.PurchaseOrder = eInv.PurchaseOrder&#xA;    LEFT JOIN tblTechPurchases ON UPPER(ePur.PurchaseOrder) = UPPER(tblTechPurchases.OrderNumber)&#xA;    WHERE ePur.PurchaseOrder &lt;&gt; ''&#xA;    AND tblTechPurchases.PurchaseUID IS NULL&#xA;    GROUP BY ePur.PurchaseOrder&#xA;&#xA;    UPDATE _ETL_Purchases&#xA;    SET PurchaseUID = tblTechPurchases.PurchaseUID, New = 1&#xA;    FROM _ETL_Purchases AS Purchases&#xA;    JOIN tblTechPurchases ON UPPER(Purchases.PurchaseOrder) = UPPER(tblTechPurchases.OrderNumber)&#xA;    WHERE Purchases.PurchaseOrder &lt;&gt; ''&#xA;    AND Purchases.PurchaseUID IS NULL&#xA;&#xA;&#x9;Update eInv&#xA;&#x9;SET PurchaseUID = tblTechPurchases.PurchaseUID&#xA;&#x9;FROM _ETL_Inventory AS eInv&#xA;    JOIN tblTechPurchases ON UPPER(eInv.PurchaseOrder) = UPPER(tblTechPurchases.OrderNumber)&#xA;    WHERE eInv.PurchaseOrder &lt;&gt; ''&#xA;    AND eInv.PurchaseUID IS NULL&#xA;&#xA;   Update _ETL_Purchases&#xA;   set PurchaseUID = 0&#xA;   where PurchaseUID is null&#xA;&#xA;   Update _ETL_Inventory&#xA;   set PurchaseUID = 0&#xA;   where PurchaseUID is null&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\09 - Locations - Opt 3"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{726EB7C7-259E-4133-8D2A-D15EE3C24E71}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="09 - Locations - Opt 3"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="    --09&#xA;&#x9;&#xA;&#x9;SET NOCOUNT ON;&#xA;    UPDATE _ETL_Inventory&#xA;    SET Location = ''&#xA;    WHERE Location IS NULL&#xA;    OR Location = 'N/A'&#xA;    OR Location = 'NONE'&#xA;    OR Location = 'UNKNOWN'&#xA;&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET SiteUID = tblTechSites.SiteUID&#xA;    FROM _ETL_Inventory AS Tags&#xA;    JOIN tblTechSites ON UPPER(Tags.Site) = UPPER(tblTechSites.SiteID)&#xA;    WHERE (Tags.SiteUID IS NULL)&#xA;&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET SiteUID = 1&#xA;    WHERE SiteUID IS NULL&#xA;&#xA;&#x9;--NOTE:  EntityTypeUID is being set when moving from staging based on location type in staging&#xA;    UPDATE _ETL_Inventory&#xA;    SET EntityUID = ISNULL(tblTeachers.TeachersUID, 0)&#xA;    FROM _ETL_Inventory AS Tags&#xA;    JOIN tblTechSites ON Tags.SiteUID = tblTechSites.SiteUID&#xA;    LEFT JOIN tblTeachers ON tblTechSites.SiteID = tblTeachers.CampusID&#xA;    AND Tags.Location = tblTeachers.TeacherID&#xA;    WHERE Tags.SiteUID &gt; 1&#xA;    AND (Tags.EntityUID IS NULL&#xA;    OR Tags.EntityUID &lt;&gt; ISNULL(tblTeachers.TeachersUID, 0))&#xA;    AND Tags.EntityTypeUID = 3&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET EntityUID = ISNULL(tblStudents.StudentsUID, 0)&#xA;    FROM _ETL_Inventory AS Tags&#xA;    JOIN tblTechSites ON Tags.SiteUID = tblTechSites.SiteUID&#xA;    LEFT JOIN tblStudents ON tblTechSites.SiteID = tblStudents.CampusID&#xA;    AND Tags.Location = tblStudents.StudentID&#xA;    WHERE Tags.SiteUID &gt; 1&#xA;    AND (Tags.EntityUID IS NULL&#xA;    OR Tags.EntityUID &lt;&gt; ISNULL(tblStudents.StudentsUID, 0))&#xA;    AND Tags.EntityTypeUID = 4&#xA;&#xA;&#x9;IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 21 AND ETLSettingValue = 'True') = 1  --evals true&#xA;&#x9;&#x9;BEGIN&#xA;&#x9;&#x9;&#x9;INSERT INTO tblUnvRooms (RoomNumber, RoomDescription, RoomTypeUID, RoomNotes, SiteUID, Active,&#xA;&#x9;&#x9;&#x9;CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#x9;&#x9;&#x9;SELECT LTRIM(RTRIM(Tags.Location)), LTRIM(RTRIM(Tags.Location)),&#xA;&#x9;&#x9;&#x9;0, 'Room created during Asset Integration',&#xA;&#x9;&#x9;&#x9;Tags.SiteUID, 1, 0, GETDATE(), 0, GETDATE()&#xA;&#x9;&#x9;&#x9;FROM _ETL_Inventory Tags&#xA;&#x9;&#x9;&#x9;LEFT JOIN tblUnvRooms AS Rooms ON Tags.SiteUID = Rooms.SiteUID&#xA;&#x9;&#x9;&#x9;AND Rooms.RoomNumber = Tags.Location&#xA;&#x9;&#x9;&#x9;WHERE Tags.SiteUID &gt; 1&#xA;&#x9;&#x9;&#x9;AND Tags.EntityTypeUID = 2&#xA;&#x9;&#x9;&#x9;AND LTRIM(RTRIM(ISNULL(Tags.Location, ''))) &lt;&gt; ''&#xA;&#x9;&#x9;&#x9;AND Rooms.RoomUID IS NULL&#xA;&#x9;&#x9;&#x9;GROUP BY Tags.SiteUID, Tags.Location&#xA;&#x9;&#x9;END&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET EntityUID = tblUnvRooms.RoomUID, EntityTypeUID = 2&#xA;    FROM _ETL_Inventory AS Tags&#xA;    JOIN tblUnvRooms ON UPPER(Tags.Location) = UPPER(tblUnvRooms.RoomNumber)&#xA;    AND Tags.SiteUID = tblUnvRooms.SiteUID&#xA;    WHERE Tags.SiteUID &gt; 1&#xA;    AND (Tags.EntityUID IS NULL)&#xA;    AND Tags.EntityTypeUID = 2&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET Location = '', EntityTypeUID = 2&#xA;    WHERE EntityUID = 0&#xA;&#xA;    DECLARE @LOCATION AS VARCHAR(50)&#xA;    SELECT @LOCATION = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 4&#xA;    IF @LOCATION IS NOT NULL&#xA;        BEGIN&#xA;            UPDATE _ETL_Inventory&#xA;            SET Location = @LOCATION&#xA;            WHERE Location = ''&#xA;        END&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET EntityUID = tblUnvRooms.RoomUID, EntityTypeUID = 2&#xA;    FROM _ETL_Inventory AS Tags&#xA;    JOIN tblUnvRooms ON UPPER(Tags.Location) = UPPER(tblUnvRooms.RoomNumber)&#xA;    AND Tags.SiteUID = tblUnvRooms.SiteUID&#xA;    WHERE Tags.SiteUID &gt; 1&#xA;    AND (Tags.EntityUID IS NULL&#xA;    OR Tags.EntityUID &lt;&gt; tblUnvRooms.RoomUID)&#xA;    AND (Tags.EntityTypeUID IS NULL&#xA;    OR Tags.EntityTypeUID = 2)&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET EntityUID = 0, EntityTypeUID = 0&#xA;    WHERE EntityUID IS NULL" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\10 - Status &amp; Dept - Opt 5"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{82BB6038-3F4D-409A-A9CC-1D8528F7F4C6}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="10 - Status &amp; Dept - Opt 5"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="--10&#xA;&#xA;    SET NOCOUNT ON;&#xA;    DECLARE @STATUS AS VARCHAR(50)&#xA;    SELECT @STATUS = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 5&#xA;    UPDATE _ETL_Inventory&#xA;    SET Status = @STATUS&#xA;    WHERE Status IS NULL&#xA;    OR Status NOT IN ('In Use', 'Available')&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET statusID = 26&#xA;    WHERE Status = 'Available'&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET statusID = 28&#xA;    WHERE Status = 'In Use'&#xA;    AND EntityTypeUID = 2&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET statusID = 31&#xA;    WHERE Status = 'In Use'&#xA;    AND EntityTypeUID = 3&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET statusID = 30&#xA;    WHERE Status = 'In Use'&#xA;    AND EntityTypeUID = 4&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET TechDepartmentUID = tblTechDepartments.TechDepartmentUID&#xA;    FROM _ETL_Inventory AS Tags&#xA;    JOIN tblTechDepartments ON UPPER(Tags.Department) = UPPER(tblTechDepartments.DepartmentName)&#xA;    WHERE Tags.Department IS NOT NULL AND Tags.Department &lt;&gt; ''&#xA;    AND Tags.Department not in ('N/A', 'NONE', 'UNKNOWN')&#xA;    AND (Tags.TechDepartmentUID IS NULL&#xA;    OR Tags.TechDepartmentUID &lt;&gt; tblTechDepartments.TechDepartmentUID)&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET TechDepartmentUID = 0&#xA;    WHERE TechDepartmentUID IS NULL" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\11 - Inventory ItemUID"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:Disabled="True"
      DTS:DTSID="{58E243C4-2486-46E1-8670-70F3D4A1F5DB}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="11 - Inventory ItemUID"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource=" --11&#xA; &#xA;    SET NOCOUNT ON;&#xA;&#xA;    IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 1 AND ETLSettingValue = 'ProductNumber') = 0  --evals true&#xA;        BEGIN&#xA;            UPDATE _ETL_Inventory&#xA;            SET ItemUID = _ETL_Items.ItemUID&#xA;            FROM _ETL_Inventory AS Tags&#xA;            JOIN _ETL_Items ON UPPER(Tags.Product) = UPPER(_ETL_Items.Product)&#xA;&#x9;&#x9;&#x9;and _ETL_Items.ItemTypeUID = tags.ItemTYpeUID&#xA;            AND UPPER(ISNULL(Tags.Model, '')) = UPPER(ISNULL(_ETL_Items.Model, ''))&#xA;            AND UPPER(ISNULL(Tags.Manufacturer, '')) = UPPER(ISNULL(_ETL_Items.Manufacturer, ''))&#xA;            AND UPPER(ISNULL(Tags.Area, '')) = UPPER(ISNULL(_ETL_Items.Area, ''))&#xA;            WHERE _ETL_Items.ItemUID &gt; 0&#xA;            AND Tags.Product IS NOT NULL AND Tags.Product &lt;&gt; ''&#xA;            AND Tags.Product &lt;&gt; 'N/A' AND Tags.Product &lt;&gt; 'NONE' AND Tags.Product &lt;&gt; 'UNKNOWN'&#xA;            AND (Tags.ItemUID IS NULL&#xA;            OR Tags.ItemUID &lt;&gt; _ETL_Items.ItemUID)&#xA;&#xA;    --        UPDATE _ETL_Inventory&#xA;    --        SET ItemUID = Items.ItemUID&#xA;    --        FROM _ETL_Inventory AS Tags&#xA;    --        JOIN (SELECT MIN(ItemUID) AS ItemUID, Product&#xA;&#x9;&#x9;&#x9;&#x9;--&#x9;FROM _ETL_Items&#xA;&#x9;&#x9;&#x9;&#x9;--&#x9;GROUP BY Product&#xA;&#x9;&#x9;&#x9;&#x9;--) AS Items&#xA;    --        ON UPPER(Tags.Product) = UPPER(Items.Product)&#xA;    --        WHERE Tags.ItemUID IS NULL&#xA;        END&#xA;&#xA;&#xA;/*&#xA;&#xA;--The assumption is that the PO already exists and it may not; see 12&#xA;&#xA;    IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 17 AND ETLSettingValue = 'True') = 1  --evals false&#xA;        BEGIN&#xA;            UPDATE _ETL_Inventory&#xA;            SET PurchaseItemDetailUID = Purchases.PurchaseItemDetailUID&#xA;            FROM _ETL_Inventory AS Tags&#xA;            JOIN (SELECT P.OrderNumber, PID.PurchasePrice,&#xA;            MIN(PID.PurchaseItemDetailUID) AS PurchaseItemDetailUID&#xA;            FROM tblTechPurchaseItemDetails PID&#xA;            JOIN tblTechPurchases P ON PID.PurchaseUID = P.PurchaseUID&#xA;            JOIN tblTechItems I ON PID.ItemUID = I.ItemUID&#xA;            WHERE PID.LineNumber &gt; 0&#xA;            GROUP BY P.OrderNumber, PID.PurchasePrice) AS Purchases&#xA;            ON Tags.PurchasePrice = Purchases.PurchasePrice&#xA;            AND Tags.PurchaseOrder = Purchases.OrderNumber&#xA;            WHERE (Tags.PurchaseItemDetailUID IS NULL&#xA;            OR Tags.PurchaseItemDetailUID &lt;&gt; Purchases.PurchaseItemDetailUID)&#xA;&#xA;            UPDATE _ETL_Inventory&#xA;            SET PurchaseItemDetailUID = Purchases.PurchaseItemDetailUID&#xA;            FROM _ETL_Inventory AS Tags&#xA;            JOIN (SELECT P.OrderNumber, I.ItemName,&#xA;            MIN(PID.PurchaseItemDetailUID) AS PurchaseItemDetailUID&#xA;            FROM tblTechPurchaseItemDetails PID&#xA;            JOIN tblTechPurchases P ON PID.PurchaseUID = P.PurchaseUID&#xA;            JOIN tblTechItems I ON PID.ItemUID = I.ItemUID&#xA;            WHERE PID.LineNumber &gt; 0&#xA;            GROUP BY P.OrderNumber, I.ItemName) AS Purchases&#xA;            ON UPPER(Tags.Product) = UPPER(Purchases.ItemName)&#xA;            AND Tags.PurchaseOrder = Purchases.OrderNumber&#xA;            WHERE (Tags.PurchaseItemDetailUID IS NULL&#xA;            OR Tags.PurchaseItemDetailUID &lt;&gt; Purchases.PurchaseItemDetailUID)&#xA;&#xA;            UPDATE _ETL_Inventory&#xA;            SET PurchaseItemDetailUID = Purchases.PurchaseItemDetailUID&#xA;            FROM _ETL_Inventory AS Tags&#xA;            JOIN (SELECT P.OrderNumber, I.ItemName, PID.PurchasePrice,&#xA;            MIN(PID.PurchaseItemDetailUID) AS PurchaseItemDetailUID&#xA;            FROM tblTechPurchaseItemDetails PID&#xA;            JOIN tblTechPurchases P ON PID.PurchaseUID = P.PurchaseUID&#xA;            JOIN tblTechItems I ON PID.ItemUID = I.ItemUID&#xA;            WHERE PID.LineNumber &gt; 0&#xA;            GROUP BY P.OrderNumber, I.ItemName, PID.PurchasePrice) AS Purchases&#xA;            ON UPPER(Tags.Product) = UPPER(Purchases.ItemName)&#xA;            AND Tags.PurchaseOrder = Purchases.OrderNumber&#xA;            AND Tags.PurchasePrice = Purchases.PurchasePrice&#xA;            WHERE (Tags.PurchaseItemDetailUID IS NULL&#xA;            OR Tags.PurchaseItemDetailUID &lt;&gt; Purchases.PurchaseItemDetailUID)&#xA;        END&#xA;    ELSE&#xA;        BEGIN&#xA;            UPDATE _ETL_Inventory&#xA;            SET PurchaseItemDetailUID = Purchases.PurchaseItemDetailUID&#xA;            FROM _ETL_Inventory AS Tags&#xA;            JOIN (SELECT P.OrderNumber, PID.PurchasePrice,&#xA;            MIN(PID.PurchaseItemDetailUID) AS PurchaseItemDetailUID&#xA;            FROM tblTechPurchaseItemDetails PID&#xA;            JOIN tblTechPurchases P ON PID.PurchaseUID = P.PurchaseUID&#xA;            JOIN tblTechItems I ON PID.ItemUID = I.ItemUID&#xA;            GROUP BY P.OrderNumber, PID.PurchasePrice) AS Purchases&#xA;            ON Tags.PurchasePrice = Purchases.PurchasePrice&#xA;            AND Tags.PurchaseOrder = Purchases.OrderNumber&#xA;            WHERE (Tags.PurchaseItemDetailUID IS NULL&#xA;            OR Tags.PurchaseItemDetailUID &lt;&gt; Purchases.PurchaseItemDetailUID)&#xA;&#xA;            UPDATE _ETL_Inventory&#xA;            SET PurchaseItemDetailUID = Purchases.PurchaseItemDetailUID&#xA;            FROM _ETL_Inventory AS Tags&#xA;            JOIN (SELECT P.OrderNumber, I.ItemName,&#xA;            MIN(PID.PurchaseItemDetailUID) AS PurchaseItemDetailUID&#xA;            FROM tblTechPurchaseItemDetails PID&#xA;            JOIN tblTechPurchases P ON PID.PurchaseUID = P.PurchaseUID&#xA;            JOIN tblTechItems I ON PID.ItemUID = I.ItemUID&#xA;            GROUP BY P.OrderNumber, I.ItemName) AS Purchases&#xA;            ON UPPER(Tags.Product) = UPPER(Purchases.ItemName)&#xA;            AND Tags.PurchaseOrder = Purchases.OrderNumber&#xA;            WHERE (Tags.PurchaseItemDetailUID IS NULL&#xA;            OR Tags.PurchaseItemDetailUID &lt;&gt; Purchases.PurchaseItemDetailUID)&#xA;&#xA;            UPDATE _ETL_Inventory&#xA;            SET PurchaseItemDetailUID = Purchases.PurchaseItemDetailUID&#xA;            FROM _ETL_Inventory AS Tags&#xA;            JOIN (SELECT P.OrderNumber, I.ItemName, PID.PurchasePrice,&#xA;            MIN(PID.PurchaseItemDetailUID) AS PurchaseItemDetailUID&#xA;            FROM tblTechPurchaseItemDetails PID&#xA;            JOIN tblTechPurchases P ON PID.PurchaseUID = P.PurchaseUID&#xA;            JOIN tblTechItems I ON PID.ItemUID = I.ItemUID&#xA;            GROUP BY P.OrderNumber, I.ItemName, PID.PurchasePrice) AS Purchases&#xA;            ON UPPER(Tags.Product) = UPPER(Purchases.ItemName)&#xA;            AND Tags.PurchaseOrder = Purchases.OrderNumber&#xA;            AND Tags.PurchasePrice = Purchases.PurchasePrice&#xA;            WHERE (Tags.PurchaseItemDetailUID IS NULL&#xA;            OR Tags.PurchaseItemDetailUID &lt;&gt; Purchases.PurchaseItemDetailUID)&#xA;        END&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET ItemUID = Purchases.ItemUID&#xA;    FROM _ETL_Inventory AS Tags&#xA;    JOIN tblTechPurchaseItemDetails AS Purchases&#xA;    ON Tags.PurchaseItemDetailUID = Purchases.PurchaseItemDetailUID&#xA;    WHERE Purchases.ItemUID &gt; 0&#xA;    AND (Tags.ItemUID IS NULL&#xA;    OR Tags.ItemUID &lt;&gt; Purchases.ItemUID)&#xA;*/&#xA;&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET ItemUID = 0&#xA;    WHERE ItemUID IS NULL" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\12 - Inventory Purchase Details"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{AA3BA2FC-EE92-43D5-A03A-5156E3DCDAB0}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="12 - Inventory Purchase Details"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="--12&#xA;&#xA;&#x9;--select * --PurchaseUID, ItemUID, FundingSourceUID, PurchasePrice, AccountCode&#xA;&#x9;update inv set PurchaseItemDetailUID = tpid.PurchaseItemDetailUID&#xA;&#x9;from _ETL_Inventory inv&#xA;&#x9;join tblTechPurchaseItemDetails tpid on inv.PurchaseUID = tpid.PurchaseUID&#xA;&#x9;and inv.ItemUID = tpid.ItemUID and inv.FundingSourceUID = tpid.FundingSourceUID &#xA;&#x9;and isNull(inv.AccountCode, '') = isNull(tpid.AccountCode, '') and isNull(inv.PurchasePrice, 0) = isNull(tpid.PurchasePrice, 0)&#xA;&#xA;&#xA;&#x9;INSERT INTO tblTechPurchaseItemDetails (PurchaseUID, ItemUID, FundingSourceUID, StatusUID,&#xA;&#x9;SiteAddedSiteUID, QuantityOrdered, QuantityReceived, PurchasePrice, AccountCode, LineNumber,&#xA;&#x9;CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#xA;&#x9;SELECT inv.PurchaseUID, inv.ItemUID, inv.FundingSourceUID, 32,&#xA;&#x9;1, count(assetID),&#xA;&#x9;count(assetid), inv.PurchasePrice, inv.AccountCode,&#xA;&#x9;0, 0, GETDATE(), 0, GETDATE()&#xA;&#x9;FROM _ETL_Inventory  inv&#xA;&#x9;WHERE inv.PurchaseUID &gt; 0&#xA;&#x9;AND inv.ItemUID &gt; 0&#xA;&#x9;AND inv.PurchaseItemDetailUID IS NULL&#xA;&#x9;GROUP BY inv.PurchaseUID, inv.ItemUID, inv.FundingSourceUID, inv.PurchasePrice, inv.AccountCode&#xA;&#xA;&#x9;update inv set PurchaseItemDetailUID = tpid.PurchaseItemDetailUID&#xA;&#x9;--select *&#xA;&#x9;from _ETL_Inventory inv&#xA;&#x9;join tblTechPurchaseItemDetails tpid on inv.PurchaseUID = tpid.PurchaseUID&#xA;&#x9;and inv.ItemUID = tpid.ItemUID and inv.FundingSourceUID = tpid.FundingSourceUID &#xA;&#x9;and isNull(inv.AccountCode, '') = isNull(tpid.AccountCode, '') and isNull(inv.PurchasePrice, 0) = isNull(tpid.PurchasePrice, 0)&#xA;&#xA;&#xA;------Jamey's old code&#xA;&#x9;--UPDATE _ETL_Purchases&#xA;&#x9;--SET TechDepartmentUID = tblTechDepartments.TechDepartmentUID&#xA;&#x9;--FROM _ETL_Purchases AS Purchases&#xA;&#x9;--JOIN tblTechDepartments ON UPPER(Purchases.Department) = UPPER(tblTechDepartments.DepartmentName)&#xA;&#x9;--WHERE Purchases.Department IS NOT NULL AND Purchases.Department &lt;&gt; ''&#xA;&#x9;--AND Purchases.Department &lt;&gt; 'N/A' AND Purchases.Department &lt;&gt; 'NONE' AND Purchases.Department &lt;&gt; 'UNKNOWN'&#xA;&#x9;--AND (Purchases.TechDepartmentUID IS NULL&#xA;&#x9;--OR Purchases.TechDepartmentUID &lt;&gt; tblTechDepartments.TechDepartmentUID)&#xA;&#xA;&#x9;--UPDATE _ETL_Purchases&#xA;&#x9;--SET TechDepartmentUID = 0&#xA;&#x9;--WHERE TechDepartmentUID IS NULL&#xA;&#xA;&#x9;--IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 17 AND ETLSettingValue = 'True') = 1&#xA;&#x9;--&#x9;BEGIN&#xA;&#x9;--&#x9;&#x9;UPDATE _ETL_Purchases&#xA;&#x9;--&#x9;&#x9;SET PurchaseItemDetailUID = tblTechPurchaseItemDetails.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseItemDetails ON Purchases.PurchaseUID = tblTechPurchaseItemDetails.PurchaseUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.LineNumber = tblTechPurchaseItemDetails.LineNumber&#xA;&#x9;--&#x9;&#x9;WHERE (Purchases.PurchaseItemDetailUID IS NULL&#xA;&#x9;--&#x9;&#x9;OR Purchases.PurchaseItemDetailUID &lt;&gt; tblTechPurchaseItemDetails.PurchaseItemDetailUID)&#xA;&#xA;&#x9;--&#x9;&#x9;UPDATE tblTechPurchaseItemDetails&#xA;&#x9;--&#x9;&#x9;SET ItemUID = Purchases.ItemUID, FundingSourceUID = Purchases.FundingSourceUID,&#xA;&#x9;--&#x9;&#x9;SiteAddedSiteUID = Purchases.SiteAddedSiteUID, QuantityOrdered = ISNULL(Purchases.QuantityOrdered, 0),&#xA;&#x9;--&#x9;&#x9;QuantityReceived = ISNULL(Purchases.QuantityReceived, 0), PurchasePrice = ISNULL(Purchases.PurchasePrice, 0),&#xA;&#x9;--&#x9;&#x9;AccountCode = Purchases.AccountCode, LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;&#x9;--&#x9;&#x9;FROM tblTechPurchaseItemDetails AS TPID&#xA;&#x9;--&#x9;&#x9;JOIN _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;ON TPID.PurchaseItemDetailUID = Purchases.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;WHERE TPID.ItemUID &gt; 0&#xA;&#x9;--&#x9;&#x9;AND (TPID.ItemUID &lt;&gt; Purchases.ItemUID&#xA;&#x9;--&#x9;&#x9;OR TPID.FundingSourceUID &lt;&gt; Purchases.FundingSourceUID&#xA;&#x9;--&#x9;&#x9;OR TPID.SiteAddedSiteUID &lt;&gt; Purchases.SiteAddedSiteUID&#xA;&#x9;--&#x9;&#x9;OR TPID.QuantityOrdered &lt;&gt; ISNULL(Purchases.QuantityOrdered, 0)&#xA;&#x9;--&#x9;&#x9;OR TPID.QuantityReceived &lt;&gt; ISNULL(Purchases.QuantityReceived, 0)&#xA;&#x9;--&#x9;&#x9;OR TPID.PurchasePrice &lt;&gt; ISNULL(Purchases.PurchasePrice, 0)&#xA;&#x9;--&#x9;&#x9;OR TPID.AccountCode &lt;&gt; Purchases.AccountCode)&#xA;&#xA;&#x9;--&#x9;&#x9;UPDATE tblTechInventory&#xA;&#x9;--&#x9;&#x9;SET PurchasePrice = TPID.PurchasePrice, FundingSourceUID = TPID.FundingSourceUID,&#xA;&#x9;--&#x9;&#x9;LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;&#x9;--&#x9;&#x9;FROM tblTechInventory AS TI&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseInventory AS TPI ON TI.InventoryUID = TPI.InventoryUID&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseItemShipments AS TPIS ON TPI.PurchaseItemShipmentUID = TPIS.PurchaseItemShipmentUID&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseItemDetails AS TPID ON TPIS.PurchaseItemDetailUID = TPID.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;WHERE TI.PurchasePrice &lt;&gt; TPID.PurchasePrice&#xA;&#x9;--&#x9;&#x9;OR TI.FundingSourceUID &lt;&gt; TPID.FundingSourceUID&#xA;&#xA;&#x9;--&#x9;&#x9;INSERT INTO tblTechPurchaseItemDetails (PurchaseUID, ItemUID, FundingSourceUID, StatusUID,&#xA;&#x9;--&#x9;&#x9;SiteAddedSiteUID, QuantityOrdered, QuantityReceived, PurchasePrice, AccountCode, LineNumber,&#xA;&#x9;--&#x9;&#x9;CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#x9;--&#x9;&#x9;SELECT Purchases.PurchaseUID, MAX(Purchases.ItemUID), MAX(Purchases.FundingSourceUID), 32,&#xA;&#x9;--&#x9;&#x9;MAX(Purchases.SiteAddedSiteUID), MAX(ISNULL(Purchases.QuantityOrdered, 0)),&#xA;&#x9;--&#x9;&#x9;MAX(ISNULL(Purchases.QuantityReceived, 0)), MAX(Purchases.PurchasePrice), MAX(Purchases.AccountCode),&#xA;&#x9;--&#x9;&#x9;Purchases.LineNumber, 0, GETDATE(), 0, GETDATE()&#xA;&#x9;--&#x9;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;LEFT JOIN tblTechPurchaseItemDetails ON Purchases.PurchaseUID = tblTechPurchaseItemDetails.PurchaseUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.LineNumber = tblTechPurchaseItemDetails.LineNumber&#xA;&#x9;--&#x9;&#x9;WHERE Purchases.PurchaseUID &gt; 0&#xA;&#x9;--&#x9;&#x9;AND Purchases.ItemUID &gt; 0&#xA;&#x9;--&#x9;&#x9;AND tblTechPurchaseItemDetails.PurchaseItemDetailUID IS NULL&#xA;&#x9;--&#x9;&#x9;GROUP BY Purchases.PurchaseUID, Purchases.LineNumber&#xA;&#xA;&#x9;--&#x9;&#x9;UPDATE _ETL_Purchases&#xA;&#x9;--&#x9;&#x9;SET PurchaseItemDetailUID = tblTechPurchaseItemDetails.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseItemDetails ON Purchases.PurchaseUID = tblTechPurchaseItemDetails.PurchaseUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.LineNumber = tblTechPurchaseItemDetails.LineNumber&#xA;&#x9;--&#x9;&#x9;WHERE (Purchases.PurchaseItemDetailUID IS NULL&#xA;&#x9;--&#x9;&#x9;OR Purchases.PurchaseItemDetailUID &lt;&gt; tblTechPurchaseItemDetails.PurchaseItemDetailUID)&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;--&#x9;&#x9;UPDATE tblTechInventory&#xA;&#x9;--&#x9;&#x9;SET ItemUID = TPID.ItemUID&#xA;&#x9;--&#x9;&#x9;FROM tblTechInventory AS Inventory&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseInventory AS TPI ON Inventory.InventoryUID = TPI.InventoryUID&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseItemShipments AS TPIS ON TPI.PurchaseItemShipmentUID = TPIS.PurchaseItemShipmentUID&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseItemDetails AS TPID ON TPIS.PurchaseItemDetailUID = TPID.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;WHERE TPID.ItemUID &gt; 0&#xA;&#x9;--&#x9;&#x9;AND Inventory.ItemUID &lt;&gt; TPID.ItemUID&#xA;&#x9;--&#x9;END&#xA;&#x9;--ELSE&#xA;&#x9;--&#x9;BEGIN&#xA;&#x9;--&#x9;&#x9;UPDATE _ETL_Purchases&#xA;&#x9;--&#x9;&#x9;SET PurchaseItemDetailUID = tblTechPurchaseItemDetails.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseItemDetails ON Purchases.PurchaseUID = tblTechPurchaseItemDetails.PurchaseUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.ItemUID = tblTechPurchaseItemDetails.ItemUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.FundingSourceUID = tblTechPurchaseItemDetails.FundingSourceUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.SiteAddedSiteUID = tblTechPurchaseItemDetails.SiteAddedSiteUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.PurchasePrice = tblTechPurchaseItemDetails.PurchasePrice&#xA;&#x9;--&#x9;&#x9;AND Purchases.AccountCode = tblTechPurchaseItemDetails.AccountCode&#xA;&#x9;--&#x9;&#x9;AND Purchases.LineNumber = tblTechPurchaseItemDetails.LineNumber&#xA;&#x9;--&#x9;&#x9;WHERE (Purchases.PurchaseItemDetailUID IS NULL&#xA;&#x9;--&#x9;&#x9;OR Purchases.PurchaseItemDetailUID &lt;&gt; tblTechPurchaseItemDetails.PurchaseItemDetailUID)&#xA;&#xA;&#x9;--&#x9;&#x9;UPDATE tblTechPurchaseItemDetails&#xA;&#x9;--&#x9;&#x9;SET QuantityOrdered = ISNULL(Purchases.QuantityOrdered, 0),&#xA;&#x9;--&#x9;&#x9;LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;&#x9;--&#x9;&#x9;FROM tblTechPurchaseItemDetails AS TPID&#xA;&#x9;--&#x9;&#x9;JOIN _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;ON TPID.PurchaseItemDetailUID = Purchases.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;WHERE TPID.QuantityOrdered &lt;&gt; ISNULL(Purchases.QuantityOrdered, 0)&#xA;&#xA;&#x9;--&#x9;&#x9;UPDATE tblTechPurchaseItemDetails&#xA;&#x9;--&#x9;&#x9;SET QuantityReceived = ISNULL(Purchases.QuantityReceived, 0),&#xA;&#x9;--&#x9;&#x9;LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;&#x9;--&#x9;&#x9;FROM tblTechPurchaseItemDetails AS TPID&#xA;&#x9;--&#x9;&#x9;JOIN _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;ON TPID.PurchaseItemDetailUID = Purchases.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;WHERE TPID.QuantityReceived &lt;&gt; ISNULL(Purchases.QuantityReceived, 0)&#xA;&#xA;&#x9;--&#x9;&#x9;INSERT INTO tblTechPurchaseItemDetails (PurchaseUID, ItemUID, FundingSourceUID, StatusUID,&#xA;&#x9;--&#x9;&#x9;SiteAddedSiteUID, QuantityOrdered, QuantityReceived, PurchasePrice, AccountCode, LineNumber,&#xA;&#x9;--&#x9;&#x9;CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#x9;--&#x9;&#x9;SELECT Purchases.PurchaseUID, Purchases.ItemUID, Purchases.FundingSourceUID, 32,&#xA;&#x9;--&#x9;&#x9;Purchases.SiteAddedSiteUID, MAX(ISNULL(Purchases.QuantityOrdered, 0)),&#xA;&#x9;--&#x9;&#x9;MAX(ISNULL(Purchases.QuantityReceived, 0)), Purchases.PurchasePrice, Purchases.AccountCode,&#xA;&#x9;--&#x9;&#x9;Purchases.LineNumber, 0, GETDATE(), 0, GETDATE()&#xA;&#x9;--&#x9;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;LEFT JOIN tblTechPurchaseItemDetails ON Purchases.PurchaseUID = tblTechPurchaseItemDetails.PurchaseUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.ItemUID = tblTechPurchaseItemDetails.ItemUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.FundingSourceUID = tblTechPurchaseItemDetails.FundingSourceUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.SiteAddedSiteUID = tblTechPurchaseItemDetails.SiteAddedSiteUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.PurchasePrice = tblTechPurchaseItemDetails.PurchasePrice&#xA;&#x9;--&#x9;&#x9;AND Purchases.AccountCode = tblTechPurchaseItemDetails.AccountCode&#xA;&#x9;--&#x9;&#x9;AND Purchases.LineNumber = tblTechPurchaseItemDetails.LineNumber&#xA;&#x9;--&#x9;&#x9;WHERE Purchases.PurchaseUID &gt; 0&#xA;&#x9;--&#x9;&#x9;AND Purchases.ItemUID &gt; 0&#xA;&#x9;--&#x9;&#x9;AND tblTechPurchaseItemDetails.PurchaseItemDetailUID IS NULL&#xA;&#x9;--&#x9;&#x9;GROUP BY Purchases.PurchaseUID, Purchases.ItemUID, Purchases.FundingSourceUID,&#xA;&#x9;--&#x9;&#x9;Purchases.SiteAddedSiteUID, Purchases.PurchasePrice, Purchases.AccountCode, Purchases.LineNumber&#xA;&#xA;&#x9;--&#x9;&#x9;UPDATE _ETL_Purchases&#xA;&#x9;--&#x9;&#x9;SET PurchaseItemDetailUID = tblTechPurchaseItemDetails.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseItemDetails ON Purchases.PurchaseUID = tblTechPurchaseItemDetails.PurchaseUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.ItemUID = tblTechPurchaseItemDetails.ItemUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.FundingSourceUID = tblTechPurchaseItemDetails.FundingSourceUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.SiteAddedSiteUID = tblTechPurchaseItemDetails.SiteAddedSiteUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.PurchasePrice = tblTechPurchaseItemDetails.PurchasePrice&#xA;&#x9;--&#x9;&#x9;AND Purchases.AccountCode = tblTechPurchaseItemDetails.AccountCode&#xA;&#x9;--&#x9;&#x9;AND Purchases.LineNumber = tblTechPurchaseItemDetails.LineNumber&#xA;&#x9;--&#x9;&#x9;WHERE (Purchases.PurchaseItemDetailUID IS NULL&#xA;&#x9;--&#x9;&#x9;OR Purchases.PurchaseItemDetailUID &lt;&gt; tblTechPurchaseItemDetails.PurchaseItemDetailUID)&#xA;&#x9;--&#x9;END&#xA;&#xA;&#x9;--UPDATE _ETL_Purchases&#xA;&#x9;--SET PurchaseItemDetailUID = 0&#xA;&#x9;--WHERE PurchaseItemDetailUID IS NULL" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\13 - Purchase Details - Opt 17"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:Disabled="True"
      DTS:DTSID="{DDDC35B1-F4FC-4D3B-8495-62EBDFFDE9E9}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="13 - Purchase Details - Opt 17"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="--13  / was 18&#xA;&#xA;&#x9;select * --PurchaseUID, ItemUID, FundingSourceUID, PurchasePrice, AccountCode&#xA;&#x9;--update inv set PurchaseItemDetailUID = tpid.PurchaseItemDetailUID&#xA;&#x9;from _ETL_Inventory inv&#xA;&#x9;join tblTechPurchaseItemDetails tpid on inv.PurchaseUID = tpid.PurchaseUID&#xA;&#x9;and inv.ItemUID = tpid.ItemUID and inv.FundingSourceUID = tpid.FundingSourceUID &#xA;&#x9;and inv.AccountCode = tpid.AccountCode and inv.FundingSourceUID = tpid.FundingSourceUID&#xA;&#xA;&#xA;&#x9;INSERT INTO tblTechPurchaseItemDetails (PurchaseUID, ItemUID, FundingSourceUID, StatusUID,&#xA;&#x9;SiteAddedSiteUID, QuantityOrdered, QuantityReceived, PurchasePrice, AccountCode, LineNumber,&#xA;&#x9;CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#xA;&#x9;SELECT inv.PurchaseUID, MAX(inv.ItemUID), MAX(inv.FundingSourceUID), 32,&#xA;&#x9;MAX(pur.SiteAddedSiteUID), count(assetID),&#xA;&#x9;count(assetid), MAX(inv.PurchasePrice), MAX(inv.AccountCode),&#xA;&#x9;0, 0, GETDATE(), 0, GETDATE()&#xA;&#x9;FROM _ETL_Inventory  inv&#xA;&#x9;join _ETL_Purchases pur on inv.PurchaseUID = pur.PurchaseUID&#xA;&#x9;WHERE inv.PurchaseUID &gt; 0&#xA;&#x9;AND inv.ItemUID &gt; 0&#xA;&#x9;AND inv.PurchaseItemDetailUID IS NULL&#xA;&#x9;GROUP BY inv.PurchaseUID, inv.ItemUID, inv.FundingSourceUID, inv.PurchasePrice, inv.AccountCode&#xA;&#xA;&#x9;update inv set PurchaseItemDetailUID = tpid.PurchaseItemDetailUID&#xA;&#x9;--select *&#xA;&#x9;from _ETL_Inventory inv&#xA;&#x9;join tblTechPurchaseItemDetails tpid on inv.PurchaseUID = tpid.PurchaseUID&#xA;&#x9;and inv.ItemUID = tpid.ItemUID and inv.FundingSourceUID = tpid.FundingSourceUID &#xA;&#x9;and inv.AccountCode = tpid.AccountCode and inv.PurchasePrice = tpid.PurchasePrice&#xA;&#xA;&#xA;&#x9;--UPDATE _ETL_Purchases&#xA;&#x9;--SET TechDepartmentUID = tblTechDepartments.TechDepartmentUID&#xA;&#x9;--FROM _ETL_Purchases AS Purchases&#xA;&#x9;--JOIN tblTechDepartments ON UPPER(Purchases.Department) = UPPER(tblTechDepartments.DepartmentName)&#xA;&#x9;--WHERE Purchases.Department IS NOT NULL AND Purchases.Department &lt;&gt; ''&#xA;&#x9;--AND Purchases.Department &lt;&gt; 'N/A' AND Purchases.Department &lt;&gt; 'NONE' AND Purchases.Department &lt;&gt; 'UNKNOWN'&#xA;&#x9;--AND (Purchases.TechDepartmentUID IS NULL&#xA;&#x9;--OR Purchases.TechDepartmentUID &lt;&gt; tblTechDepartments.TechDepartmentUID)&#xA;&#xA;&#x9;--UPDATE _ETL_Purchases&#xA;&#x9;--SET TechDepartmentUID = 0&#xA;&#x9;--WHERE TechDepartmentUID IS NULL&#xA;&#xA;&#x9;--IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 17 AND ETLSettingValue = 'True') = 1&#xA;&#x9;--&#x9;BEGIN&#xA;&#x9;--&#x9;&#x9;UPDATE _ETL_Purchases&#xA;&#x9;--&#x9;&#x9;SET PurchaseItemDetailUID = tblTechPurchaseItemDetails.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseItemDetails ON Purchases.PurchaseUID = tblTechPurchaseItemDetails.PurchaseUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.LineNumber = tblTechPurchaseItemDetails.LineNumber&#xA;&#x9;--&#x9;&#x9;WHERE (Purchases.PurchaseItemDetailUID IS NULL&#xA;&#x9;--&#x9;&#x9;OR Purchases.PurchaseItemDetailUID &lt;&gt; tblTechPurchaseItemDetails.PurchaseItemDetailUID)&#xA;&#xA;&#x9;--&#x9;&#x9;UPDATE tblTechPurchaseItemDetails&#xA;&#x9;--&#x9;&#x9;SET ItemUID = Purchases.ItemUID, FundingSourceUID = Purchases.FundingSourceUID,&#xA;&#x9;--&#x9;&#x9;SiteAddedSiteUID = Purchases.SiteAddedSiteUID, QuantityOrdered = ISNULL(Purchases.QuantityOrdered, 0),&#xA;&#x9;--&#x9;&#x9;QuantityReceived = ISNULL(Purchases.QuantityReceived, 0), PurchasePrice = ISNULL(Purchases.PurchasePrice, 0),&#xA;&#x9;--&#x9;&#x9;AccountCode = Purchases.AccountCode, LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;&#x9;--&#x9;&#x9;FROM tblTechPurchaseItemDetails AS TPID&#xA;&#x9;--&#x9;&#x9;JOIN _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;ON TPID.PurchaseItemDetailUID = Purchases.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;WHERE TPID.ItemUID &gt; 0&#xA;&#x9;--&#x9;&#x9;AND (TPID.ItemUID &lt;&gt; Purchases.ItemUID&#xA;&#x9;--&#x9;&#x9;OR TPID.FundingSourceUID &lt;&gt; Purchases.FundingSourceUID&#xA;&#x9;--&#x9;&#x9;OR TPID.SiteAddedSiteUID &lt;&gt; Purchases.SiteAddedSiteUID&#xA;&#x9;--&#x9;&#x9;OR TPID.QuantityOrdered &lt;&gt; ISNULL(Purchases.QuantityOrdered, 0)&#xA;&#x9;--&#x9;&#x9;OR TPID.QuantityReceived &lt;&gt; ISNULL(Purchases.QuantityReceived, 0)&#xA;&#x9;--&#x9;&#x9;OR TPID.PurchasePrice &lt;&gt; ISNULL(Purchases.PurchasePrice, 0)&#xA;&#x9;--&#x9;&#x9;OR TPID.AccountCode &lt;&gt; Purchases.AccountCode)&#xA;&#xA;&#x9;--&#x9;&#x9;UPDATE tblTechInventory&#xA;&#x9;--&#x9;&#x9;SET PurchasePrice = TPID.PurchasePrice, FundingSourceUID = TPID.FundingSourceUID,&#xA;&#x9;--&#x9;&#x9;LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;&#x9;--&#x9;&#x9;FROM tblTechInventory AS TI&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseInventory AS TPI ON TI.InventoryUID = TPI.InventoryUID&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseItemShipments AS TPIS ON TPI.PurchaseItemShipmentUID = TPIS.PurchaseItemShipmentUID&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseItemDetails AS TPID ON TPIS.PurchaseItemDetailUID = TPID.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;WHERE TI.PurchasePrice &lt;&gt; TPID.PurchasePrice&#xA;&#x9;--&#x9;&#x9;OR TI.FundingSourceUID &lt;&gt; TPID.FundingSourceUID&#xA;&#xA;&#x9;--&#x9;&#x9;INSERT INTO tblTechPurchaseItemDetails (PurchaseUID, ItemUID, FundingSourceUID, StatusUID,&#xA;&#x9;--&#x9;&#x9;SiteAddedSiteUID, QuantityOrdered, QuantityReceived, PurchasePrice, AccountCode, LineNumber,&#xA;&#x9;--&#x9;&#x9;CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#x9;--&#x9;&#x9;SELECT Purchases.PurchaseUID, MAX(Purchases.ItemUID), MAX(Purchases.FundingSourceUID), 32,&#xA;&#x9;--&#x9;&#x9;MAX(Purchases.SiteAddedSiteUID), MAX(ISNULL(Purchases.QuantityOrdered, 0)),&#xA;&#x9;--&#x9;&#x9;MAX(ISNULL(Purchases.QuantityReceived, 0)), MAX(Purchases.PurchasePrice), MAX(Purchases.AccountCode),&#xA;&#x9;--&#x9;&#x9;Purchases.LineNumber, 0, GETDATE(), 0, GETDATE()&#xA;&#x9;--&#x9;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;LEFT JOIN tblTechPurchaseItemDetails ON Purchases.PurchaseUID = tblTechPurchaseItemDetails.PurchaseUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.LineNumber = tblTechPurchaseItemDetails.LineNumber&#xA;&#x9;--&#x9;&#x9;WHERE Purchases.PurchaseUID &gt; 0&#xA;&#x9;--&#x9;&#x9;AND Purchases.ItemUID &gt; 0&#xA;&#x9;--&#x9;&#x9;AND tblTechPurchaseItemDetails.PurchaseItemDetailUID IS NULL&#xA;&#x9;--&#x9;&#x9;GROUP BY Purchases.PurchaseUID, Purchases.LineNumber&#xA;&#xA;&#x9;--&#x9;&#x9;UPDATE _ETL_Purchases&#xA;&#x9;--&#x9;&#x9;SET PurchaseItemDetailUID = tblTechPurchaseItemDetails.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseItemDetails ON Purchases.PurchaseUID = tblTechPurchaseItemDetails.PurchaseUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.LineNumber = tblTechPurchaseItemDetails.LineNumber&#xA;&#x9;--&#x9;&#x9;WHERE (Purchases.PurchaseItemDetailUID IS NULL&#xA;&#x9;--&#x9;&#x9;OR Purchases.PurchaseItemDetailUID &lt;&gt; tblTechPurchaseItemDetails.PurchaseItemDetailUID)&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;--&#x9;&#x9;UPDATE tblTechInventory&#xA;&#x9;--&#x9;&#x9;SET ItemUID = TPID.ItemUID&#xA;&#x9;--&#x9;&#x9;FROM tblTechInventory AS Inventory&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseInventory AS TPI ON Inventory.InventoryUID = TPI.InventoryUID&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseItemShipments AS TPIS ON TPI.PurchaseItemShipmentUID = TPIS.PurchaseItemShipmentUID&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseItemDetails AS TPID ON TPIS.PurchaseItemDetailUID = TPID.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;WHERE TPID.ItemUID &gt; 0&#xA;&#x9;--&#x9;&#x9;AND Inventory.ItemUID &lt;&gt; TPID.ItemUID&#xA;&#x9;--&#x9;END&#xA;&#x9;--ELSE&#xA;&#x9;--&#x9;BEGIN&#xA;&#x9;--&#x9;&#x9;UPDATE _ETL_Purchases&#xA;&#x9;--&#x9;&#x9;SET PurchaseItemDetailUID = tblTechPurchaseItemDetails.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseItemDetails ON Purchases.PurchaseUID = tblTechPurchaseItemDetails.PurchaseUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.ItemUID = tblTechPurchaseItemDetails.ItemUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.FundingSourceUID = tblTechPurchaseItemDetails.FundingSourceUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.SiteAddedSiteUID = tblTechPurchaseItemDetails.SiteAddedSiteUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.PurchasePrice = tblTechPurchaseItemDetails.PurchasePrice&#xA;&#x9;--&#x9;&#x9;AND Purchases.AccountCode = tblTechPurchaseItemDetails.AccountCode&#xA;&#x9;--&#x9;&#x9;AND Purchases.LineNumber = tblTechPurchaseItemDetails.LineNumber&#xA;&#x9;--&#x9;&#x9;WHERE (Purchases.PurchaseItemDetailUID IS NULL&#xA;&#x9;--&#x9;&#x9;OR Purchases.PurchaseItemDetailUID &lt;&gt; tblTechPurchaseItemDetails.PurchaseItemDetailUID)&#xA;&#xA;&#x9;--&#x9;&#x9;UPDATE tblTechPurchaseItemDetails&#xA;&#x9;--&#x9;&#x9;SET QuantityOrdered = ISNULL(Purchases.QuantityOrdered, 0),&#xA;&#x9;--&#x9;&#x9;LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;&#x9;--&#x9;&#x9;FROM tblTechPurchaseItemDetails AS TPID&#xA;&#x9;--&#x9;&#x9;JOIN _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;ON TPID.PurchaseItemDetailUID = Purchases.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;WHERE TPID.QuantityOrdered &lt;&gt; ISNULL(Purchases.QuantityOrdered, 0)&#xA;&#xA;&#x9;--&#x9;&#x9;UPDATE tblTechPurchaseItemDetails&#xA;&#x9;--&#x9;&#x9;SET QuantityReceived = ISNULL(Purchases.QuantityReceived, 0),&#xA;&#x9;--&#x9;&#x9;LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;&#x9;--&#x9;&#x9;FROM tblTechPurchaseItemDetails AS TPID&#xA;&#x9;--&#x9;&#x9;JOIN _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;ON TPID.PurchaseItemDetailUID = Purchases.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;WHERE TPID.QuantityReceived &lt;&gt; ISNULL(Purchases.QuantityReceived, 0)&#xA;&#xA;&#x9;--&#x9;&#x9;INSERT INTO tblTechPurchaseItemDetails (PurchaseUID, ItemUID, FundingSourceUID, StatusUID,&#xA;&#x9;--&#x9;&#x9;SiteAddedSiteUID, QuantityOrdered, QuantityReceived, PurchasePrice, AccountCode, LineNumber,&#xA;&#x9;--&#x9;&#x9;CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#x9;--&#x9;&#x9;SELECT Purchases.PurchaseUID, Purchases.ItemUID, Purchases.FundingSourceUID, 32,&#xA;&#x9;--&#x9;&#x9;Purchases.SiteAddedSiteUID, MAX(ISNULL(Purchases.QuantityOrdered, 0)),&#xA;&#x9;--&#x9;&#x9;MAX(ISNULL(Purchases.QuantityReceived, 0)), Purchases.PurchasePrice, Purchases.AccountCode,&#xA;&#x9;--&#x9;&#x9;Purchases.LineNumber, 0, GETDATE(), 0, GETDATE()&#xA;&#x9;--&#x9;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;LEFT JOIN tblTechPurchaseItemDetails ON Purchases.PurchaseUID = tblTechPurchaseItemDetails.PurchaseUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.ItemUID = tblTechPurchaseItemDetails.ItemUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.FundingSourceUID = tblTechPurchaseItemDetails.FundingSourceUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.SiteAddedSiteUID = tblTechPurchaseItemDetails.SiteAddedSiteUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.PurchasePrice = tblTechPurchaseItemDetails.PurchasePrice&#xA;&#x9;--&#x9;&#x9;AND Purchases.AccountCode = tblTechPurchaseItemDetails.AccountCode&#xA;&#x9;--&#x9;&#x9;AND Purchases.LineNumber = tblTechPurchaseItemDetails.LineNumber&#xA;&#x9;--&#x9;&#x9;WHERE Purchases.PurchaseUID &gt; 0&#xA;&#x9;--&#x9;&#x9;AND Purchases.ItemUID &gt; 0&#xA;&#x9;--&#x9;&#x9;AND tblTechPurchaseItemDetails.PurchaseItemDetailUID IS NULL&#xA;&#x9;--&#x9;&#x9;GROUP BY Purchases.PurchaseUID, Purchases.ItemUID, Purchases.FundingSourceUID,&#xA;&#x9;--&#x9;&#x9;Purchases.SiteAddedSiteUID, Purchases.PurchasePrice, Purchases.AccountCode, Purchases.LineNumber&#xA;&#xA;&#x9;--&#x9;&#x9;UPDATE _ETL_Purchases&#xA;&#x9;--&#x9;&#x9;SET PurchaseItemDetailUID = tblTechPurchaseItemDetails.PurchaseItemDetailUID&#xA;&#x9;--&#x9;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;--&#x9;&#x9;JOIN tblTechPurchaseItemDetails ON Purchases.PurchaseUID = tblTechPurchaseItemDetails.PurchaseUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.ItemUID = tblTechPurchaseItemDetails.ItemUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.FundingSourceUID = tblTechPurchaseItemDetails.FundingSourceUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.SiteAddedSiteUID = tblTechPurchaseItemDetails.SiteAddedSiteUID&#xA;&#x9;--&#x9;&#x9;AND Purchases.PurchasePrice = tblTechPurchaseItemDetails.PurchasePrice&#xA;&#x9;--&#x9;&#x9;AND Purchases.AccountCode = tblTechPurchaseItemDetails.AccountCode&#xA;&#x9;--&#x9;&#x9;AND Purchases.LineNumber = tblTechPurchaseItemDetails.LineNumber&#xA;&#x9;--&#x9;&#x9;WHERE (Purchases.PurchaseItemDetailUID IS NULL&#xA;&#x9;--&#x9;&#x9;OR Purchases.PurchaseItemDetailUID &lt;&gt; tblTechPurchaseItemDetails.PurchaseItemDetailUID)&#xA;&#x9;--&#x9;END&#xA;&#xA;&#x9;--UPDATE _ETL_Purchases&#xA;&#x9;--SET PurchaseItemDetailUID = 0&#xA;&#x9;--WHERE PurchaseItemDetailUID IS NULL" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\14 - Custom Fields Update - Opt 7-14"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:Disabled="True"
      DTS:DTSID="{A337D225-88FD-4073-81AE-6B64EA284EB3}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="14 - Custom Fields Update - Opt 7-14"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="&#x9;SET NOCOUNT ON;&#xA;&#x9;DECLARE @Label VARCHAR(50)&#xA;&#x9;DECLARE @Type VARCHAR(50)&#xA;&#xA;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;SET ItemTypeUID = tblTechItems.ItemTypeUID&#xA;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;JOIN tblTechItems ON Tags.ItemUID = tblTechItems.ItemUID&#xA;&#x9;WHERE Tags.ItemTypeUID IS NULL&#xA;&#x9;OR (Tags.ItemTypeUID &lt;&gt; tblTechItems.ItemTypeUID)&#xA;&#xA;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;SET ItemTypeUID = 0&#xA;&#x9;WHERE ItemTypeUID IS NULL&#xA;&#xA;&#x9;IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 7 AND ETLSettingValue &lt;&gt; '') = 1&#xA;&#x9;&#x9;BEGIN&#xA;&#x9;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;&#x9;SET InventoryMeta1UID = tblTechInventoryMeta.InventoryMetaUID&#xA;&#x9;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;&#x9;JOIN tblTechInventoryMeta ON Tags.ItemTypeUID = tblTechInventoryMeta.ItemTypeUID&#xA;&#x9;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaOrder = 1&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND (Tags.InventoryMeta1UID IS NULL&#xA;&#x9;&#x9;&#x9;OR Tags.InventoryMeta1UID &lt;&gt; tblTechInventoryMeta.InventoryMetaUID)&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;SELECT @Label = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 7&#xA;&#x9;&#x9;&#x9;SELECT @Type = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 8&#xA;&#x9;&#x9;&#x9;UPDATE tblTechInventoryMeta&#xA;&#x9;&#x9;&#x9;SET InventoryMetaLabel = @Label, InventoryMetaType = @Type&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryMeta&#xA;&#x9;&#x9;&#x9;JOIN _ETL_Inventory AS Tags ON tblTechInventoryMeta.ItemTypeUID = Tags.ItemTypeUID&#xA;&#x9;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaOrder = 1&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND (tblTechInventoryMeta.InventoryMetaLabel &lt;&gt; @Label&#xA;&#x9;&#x9;&#x9;OR tblTechInventoryMeta.InventoryMetaType &lt;&gt; @Type)&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;&#x9;SET InventoryExt1UID = tblTechInventoryExt.InventoryExtUID&#xA;&#x9;&#x9;&#x9;FROM _ETL_Inventory as Tags&#xA;&#x9;&#x9;&#x9;JOIN tblTechInventoryExt ON Tags.InventoryMeta1UID = tblTechInventoryExt.InventoryMetaUID&#xA;&#x9;&#x9;&#x9;AND Tags.InventoryUID = tblTechInventoryExt.InventoryUID&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND (Tags.InventoryExt1UID IS NULL&#xA;&#x9;&#x9;&#x9;OR Tags.InventoryExt1UID &lt;&gt; tblTechInventoryExt.InventoryExtUID)&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;UPDATE tblTechInventoryExt&#xA;&#x9;&#x9;&#x9;SET InventoryExtValue = Tags.CustomField1&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryExt&#xA;&#x9;&#x9;&#x9;JOIN _ETL_Inventory AS Tags ON tblTechInventoryExt.InventoryMetaUID = Tags.InventoryMeta1UID&#xA;&#x9;&#x9;&#x9;AND tblTechInventoryExt.InventoryUID = Tags.InventoryUID&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND tblTechInventoryExt.InventoryExtValue &lt;&gt; Tags.CustomField1&#xA;&#x9;&#x9;&#x9;AND Tags.CustomField1 IS NOT NULL&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;DELETE old&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryExt AS old&#xA;&#x9;&#x9;&#x9;JOIN _ETL_Inventory AS Tags ON old.InventoryUID = Tags.InventoryUID&#xA;&#x9;&#x9;&#x9;AND old.InventoryMetaUID = Tags.InventoryMeta1UID&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND old.InventoryExtUID &lt;&gt; Tags.InventoryExt1UID&#xA;&#x9;&#x9;&#x9;AND Tags.InventoryExt1UID IS NOT NULL&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;DELETE old&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryMeta AS old&#xA;&#x9;&#x9;&#x9;JOIN _ETL_Inventory AS Tags ON old.ItemTypeUID = Tags.ItemTypeUID&#xA;&#x9;&#x9;&#x9;AND old.InventoryMetaOrder = 1&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND old.InventoryMetaUID &lt;&gt; Tags.InventoryMeta1UID&#xA;&#x9;&#x9;&#x9;AND Tags.InventoryMeta1UID IS NOT NULL&#xA;&#x9;&#x9;END&#xA;&#xA;&#x9;IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 9 AND ETLSettingValue &lt;&gt; '') = 1&#xA;&#x9;&#x9;BEGIN&#xA;&#x9;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;&#x9;SET InventoryMeta2UID = tblTechInventoryMeta.InventoryMetaUID&#xA;&#x9;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;&#x9;JOIN tblTechInventoryMeta ON Tags.ItemTypeUID = tblTechInventoryMeta.ItemTypeUID&#xA;&#x9;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaOrder = 2&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND (Tags.InventoryMeta2UID IS NULL&#xA;&#x9;&#x9;&#x9;OR Tags.InventoryMeta2UID &lt;&gt; tblTechInventoryMeta.InventoryMetaUID)&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;SELECT @Label = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 9&#xA;&#x9;&#x9;&#x9;SELECT @Type = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 10&#xA;&#x9;&#x9;&#x9;UPDATE tblTechInventoryMeta&#xA;&#x9;&#x9;&#x9;SET InventoryMetaLabel = @Label, InventoryMetaType = @Type&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryMeta&#xA;&#x9;&#x9;&#x9;JOIN _ETL_Inventory AS Tags ON tblTechInventoryMeta.ItemTypeUID = Tags.ItemTypeUID&#xA;&#x9;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaOrder = 2&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND (tblTechInventoryMeta.InventoryMetaLabel &lt;&gt; @Label&#xA;&#x9;&#x9;&#x9;OR tblTechInventoryMeta.InventoryMetaType &lt;&gt; @Type)&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;&#x9;SET InventoryExt2UID = tblTechInventoryExt.InventoryExtUID&#xA;&#x9;&#x9;&#x9;FROM _ETL_Inventory as Tags&#xA;&#x9;&#x9;&#x9;JOIN tblTechInventoryExt ON Tags.InventoryMeta2UID = tblTechInventoryExt.InventoryMetaUID&#xA;&#x9;&#x9;&#x9;AND Tags.InventoryUID = tblTechInventoryExt.InventoryUID&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND (Tags.InventoryExt2UID IS NULL&#xA;&#x9;&#x9;&#x9;OR Tags.InventoryExt2UID &lt;&gt; tblTechInventoryExt.InventoryExtUID)&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;UPDATE tblTechInventoryExt&#xA;&#x9;&#x9;&#x9;SET InventoryExtValue = Tags.CustomField2&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryExt&#xA;&#x9;&#x9;&#x9;JOIN _ETL_Inventory AS Tags ON tblTechInventoryExt.InventoryMetaUID = Tags.InventoryMeta2UID&#xA;&#x9;&#x9;&#x9;AND tblTechInventoryExt.InventoryUID = Tags.InventoryUID&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND tblTechInventoryExt.InventoryExtValue &lt;&gt; Tags.CustomField2&#xA;&#x9;&#x9;&#x9;AND Tags.CustomField2 IS NOT NULL&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;DELETE old&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryExt AS old&#xA;&#x9;&#x9;&#x9;JOIN _ETL_Inventory AS Tags ON old.InventoryUID = Tags.InventoryUID&#xA;&#x9;&#x9;&#x9;AND old.InventoryMetaUID = Tags.InventoryMeta2UID&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND old.InventoryExtUID &lt;&gt; Tags.InventoryExt2UID&#xA;&#x9;&#x9;&#x9;AND Tags.InventoryExt2UID IS NOT NULL&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;DELETE old&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryMeta AS old&#xA;&#x9;&#x9;&#x9;JOIN _ETL_Inventory AS Tags ON old.ItemTypeUID = Tags.ItemTypeUID&#xA;&#x9;&#x9;&#x9;AND old.InventoryMetaOrder = 2&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND old.InventoryMetaUID &lt;&gt; Tags.InventoryMeta2UID&#xA;&#x9;&#x9;&#x9;AND Tags.InventoryMeta2UID IS NOT NULL&#xA;&#x9;&#x9;END&#xA;&#xA;&#x9;IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 11 AND ETLSettingValue &lt;&gt; '') = 1&#xA;&#x9;&#x9;BEGIN&#xA;&#x9;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;&#x9;SET InventoryMeta3UID = tblTechInventoryMeta.InventoryMetaUID&#xA;&#x9;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;&#x9;JOIN tblTechInventoryMeta ON Tags.ItemTypeUID = tblTechInventoryMeta.ItemTypeUID&#xA;&#x9;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaOrder = 3&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND (Tags.InventoryMeta3UID IS NULL&#xA;&#x9;&#x9;&#x9;OR Tags.InventoryMeta3UID &lt;&gt; tblTechInventoryMeta.InventoryMetaUID)&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;SELECT @Label = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 11&#xA;&#x9;&#x9;&#x9;SELECT @Type = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 12&#xA;&#x9;&#x9;&#x9;UPDATE tblTechInventoryMeta&#xA;&#x9;&#x9;&#x9;SET InventoryMetaLabel = @Label, InventoryMetaType = @Type&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryMeta&#xA;&#x9;&#x9;&#x9;JOIN _ETL_Inventory AS Tags ON tblTechInventoryMeta.ItemTypeUID = Tags.ItemTypeUID&#xA;&#x9;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaOrder = 3&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND (tblTechInventoryMeta.InventoryMetaLabel &lt;&gt; @Label&#xA;&#x9;&#x9;&#x9;OR tblTechInventoryMeta.InventoryMetaType &lt;&gt; @Type)&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;&#x9;SET InventoryExt3UID = tblTechInventoryExt.InventoryExtUID&#xA;&#x9;&#x9;&#x9;FROM _ETL_Inventory as Tags&#xA;&#x9;&#x9;&#x9;JOIN tblTechInventoryExt ON Tags.InventoryMeta3UID = tblTechInventoryExt.InventoryMetaUID&#xA;&#x9;&#x9;&#x9;AND Tags.InventoryUID = tblTechInventoryExt.InventoryUID&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND (Tags.InventoryExt3UID IS NULL&#xA;&#x9;&#x9;&#x9;OR Tags.InventoryExt3UID &lt;&gt; tblTechInventoryExt.InventoryExtUID)&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;UPDATE tblTechInventoryExt&#xA;&#x9;&#x9;&#x9;SET InventoryExtValue = Tags.CustomField3&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryExt&#xA;&#x9;&#x9;&#x9;JOIN _ETL_Inventory AS Tags ON tblTechInventoryExt.InventoryMetaUID = Tags.InventoryMeta3UID&#xA;&#x9;&#x9;&#x9;AND tblTechInventoryExt.InventoryUID = Tags.InventoryUID&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND tblTechInventoryExt.InventoryExtValue &lt;&gt; Tags.CustomField3&#xA;&#x9;&#x9;&#x9;AND Tags.CustomField3 IS NOT NULL&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;DELETE old&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryExt AS old&#xA;&#x9;&#x9;&#x9;JOIN _ETL_Inventory AS Tags ON old.InventoryUID = Tags.InventoryUID&#xA;&#x9;&#x9;&#x9;AND old.InventoryMetaUID = Tags.InventoryMeta3UID&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND old.InventoryExtUID &lt;&gt; Tags.InventoryExt3UID&#xA;&#x9;&#x9;&#x9;AND Tags.InventoryExt3UID IS NOT NULL&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;DELETE old&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryMeta AS old&#xA;&#x9;&#x9;&#x9;JOIN _ETL_Inventory AS Tags ON old.ItemTypeUID = Tags.ItemTypeUID&#xA;&#x9;&#x9;&#x9;AND old.InventoryMetaOrder = 3&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND old.InventoryMetaUID &lt;&gt; Tags.InventoryMeta3UID&#xA;&#x9;&#x9;&#x9;AND Tags.InventoryMeta3UID IS NOT NULL&#xA;&#x9;&#x9;END&#xA;&#xA;&#x9;IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 13 AND ETLSettingValue &lt;&gt; '') = 1&#xA;&#x9;&#x9;BEGIN&#xA;&#x9;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;&#x9;SET InventoryMeta4UID = tblTechInventoryMeta.InventoryMetaUID&#xA;&#x9;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;&#x9;JOIN tblTechInventoryMeta ON Tags.ItemTypeUID = tblTechInventoryMeta.ItemTypeUID&#xA;&#x9;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaOrder = 4&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND (Tags.InventoryMeta4UID IS NULL&#xA;&#x9;&#x9;&#x9;OR Tags.InventoryMeta4UID &lt;&gt; tblTechInventoryMeta.InventoryMetaUID)&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;SELECT @Label = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 13&#xA;&#x9;&#x9;&#x9;SELECT @Type = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 14&#xA;&#x9;&#x9;&#x9;UPDATE tblTechInventoryMeta&#xA;&#x9;&#x9;&#x9;SET InventoryMetaLabel = @Label, InventoryMetaType = @Type&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryMeta&#xA;&#x9;&#x9;&#x9;JOIN _ETL_Inventory AS Tags ON tblTechInventoryMeta.ItemTypeUID = Tags.ItemTypeUID&#xA;&#x9;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaOrder = 4&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND (tblTechInventoryMeta.InventoryMetaLabel &lt;&gt; @Label&#xA;&#x9;&#x9;&#x9;OR tblTechInventoryMeta.InventoryMetaType &lt;&gt; @Type)&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;&#x9;SET InventoryExt4UID = tblTechInventoryExt.InventoryExtUID&#xA;&#x9;&#x9;&#x9;FROM _ETL_Inventory as Tags&#xA;&#x9;&#x9;&#x9;JOIN tblTechInventoryExt ON Tags.InventoryMeta4UID = tblTechInventoryExt.InventoryMetaUID&#xA;&#x9;&#x9;&#x9;AND Tags.InventoryUID = tblTechInventoryExt.InventoryUID&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND (Tags.InventoryExt4UID IS NULL&#xA;&#x9;&#x9;&#x9;OR Tags.InventoryExt4UID &lt;&gt; tblTechInventoryExt.InventoryExtUID)&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;UPDATE tblTechInventoryExt&#xA;&#x9;&#x9;&#x9;SET InventoryExtValue = Tags.CustomField4&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryExt&#xA;&#x9;&#x9;&#x9;JOIN _ETL_Inventory AS Tags ON tblTechInventoryExt.InventoryMetaUID = Tags.InventoryMeta4UID&#xA;&#x9;&#x9;&#x9;AND tblTechInventoryExt.InventoryUID = Tags.InventoryUID&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND tblTechInventoryExt.InventoryExtValue &lt;&gt; Tags.CustomField4&#xA;&#x9;&#x9;&#x9;AND Tags.CustomField4 IS NOT NULL&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;DELETE old&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryExt AS old&#xA;&#x9;&#x9;&#x9;JOIN _ETL_Inventory AS Tags ON old.InventoryUID = Tags.InventoryUID&#xA;&#x9;&#x9;&#x9;AND old.InventoryMetaUID = Tags.InventoryMeta4UID&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND old.InventoryExtUID &lt;&gt; Tags.InventoryExt4UID&#xA;&#x9;&#x9;&#x9;AND Tags.InventoryExt4UID IS NOT NULL&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;DELETE old&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryMeta AS old&#xA;&#x9;&#x9;&#x9;JOIN _ETL_Inventory AS Tags ON old.ItemTypeUID = Tags.ItemTypeUID&#xA;&#x9;&#x9;&#x9;AND old.InventoryMetaOrder = 4&#xA;&#x9;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;&#x9;AND old.InventoryMetaUID &lt;&gt; Tags.InventoryMeta4UID&#xA;&#x9;&#x9;&#x9;AND Tags.InventoryMeta4UID IS NOT NULL&#xA;&#x9;&#x9;END" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\14 - Inventory Update"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{711885EF-54C9-48FD-8B4C-FA80880785CC}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="14 - Inventory Update"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="--14&#xA;&#xA;&#x9;SET NOCOUNT ON;&#xA;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;SET Serial = ''&#xA;&#x9;WHERE Serial IS NULL&#xA;&#x9;OR Serial = 'N/A'&#xA;&#x9;OR Serial = 'NONE'&#xA;&#x9;OR Serial = 'UNKNOWN'&#xA;&#xA;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;SET InventoryUID = tblTechInventory.InventoryUID&#xA;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;JOIN tblTechInventory ON UPPER(Tags.AssetID) = UPPER(tblTechInventory.AssetID)&#xA;&#x9;WHERE (Tags.InventoryUID IS NULL&#xA;&#x9;OR Tags.InventoryUID &lt;&gt; tblTechInventory.InventoryUID)&#xA;&#xA;&#xA;&#x9;insert tblTechTagHistory&#xA;&#x9;(InventoryUID, Tag, OriginTag, CreatedByUserID, CreateDate)&#xA;&#x9;select ti.InventoryUID, tags.Tag, ti.Tag, 0, getdate()&#xA;&#x9;FROM tblTechInventory AS TI&#xA;&#x9;JOIN _ETL_Inventory AS Tags ON TI.InventoryUID = Tags.InventoryUID&#xA;&#x9;WHERE TI.Tag &lt;&gt; Tags.Tag&#xA;&#xA;&#x9;UPDATE tblTechInventory&#xA;&#x9;SET Tag = Tags.Tag,&#xA;&#x9;LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;&#x9;FROM tblTechInventory AS TI&#xA;&#x9;JOIN _ETL_Inventory AS Tags ON TI.InventoryUID = Tags.InventoryUID&#xA;&#x9;WHERE TI.Tag &lt;&gt; Tags.Tag&#xA;&#xA;&#x9;UPDATE tblTechInventory&#xA;&#x9;SET Serial = Tags.Serial,&#xA;&#x9;LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;&#x9;FROM tblTechInventory AS TI&#xA;&#x9;JOIN _ETL_Inventory AS Tags ON TI.InventoryUID = Tags.InventoryUID&#xA;&#x9;WHERE TI.Serial &lt;&gt; Tags.Serial&#xA;&#xA;&#xA;&#x9;UPDATE tblTechInventory&#xA;&#x9;SET ItemUID = Tags.ItemUID,&#xA;&#x9;LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;&#x9;FROM tblTechInventory AS TI&#xA;&#x9;JOIN _ETL_Inventory AS Tags ON TI.InventoryUID = Tags.InventoryUID&#xA;&#x9;WHERE Tags.ItemUID &gt; 0&#xA;&#x9;AND TI.ItemUID &lt;&gt; Tags.ItemUID&#xA;&#xA;&#x9;UPDATE tblTechInventory&#xA;&#x9;SET FundingSourceUID = Tags.FundingSourceUID,&#xA;&#x9;LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;&#x9;FROM tblTechInventory AS TI&#xA;&#x9;JOIN _ETL_Inventory AS Tags ON TI.InventoryUID = Tags.InventoryUID&#xA;&#x9;WHERE TI.FundingSourceUID is null or (TI.FundingSourceUID is not null and TI.FundingSourceUID  &lt;&gt; Tags.FundingSourceUID)&#xA;&#xA;&#x9;UPDATE tblTechInventoryHistory&#xA;&#x9;SET InventoryTypeUID = tblTechInventory.InventoryTypeUID,&#xA;&#x9;LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;&#x9;FROM tblTechInventoryHistory AS TIH&#xA;&#x9;JOIN tblTechInventory ON TIH.InventoryUID = tblTechInventory.InventoryUID&#xA;&#x9;WHERE TIH.InventoryTypeUID &lt;&gt; tblTechInventory.InventoryTypeUID&#xA;&#xA;&#x9;UPDATE tblTechInventory&#xA;&#x9;SET InventoryTypeUID = Tags.InventoryTypeUID,&#xA;&#x9;LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;&#x9;FROM tblTechInventory AS TI&#xA;&#x9;JOIN _ETL_Inventory AS Tags ON TI.InventoryUID = Tags.InventoryUID&#xA;&#x9;WHERE TI.InventoryTypeUID &lt;&gt; Tags.InventoryTypeUID&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\15 - Inventory Insert"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{1B633D2E-672D-4085-A835-219B72A5477F}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="15 - Inventory Insert"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="&#xA;--15&#xA;&#xA;    SET NOCOUNT ON;&#xA;    UPDATE _ETL_Inventory&#xA;    SET Department = ''&#xA;    WHERE Department IS NULL&#xA;    OR Department = 'N/A'&#xA;    OR Department = 'NONE'&#xA;    OR Department = 'UNKNOWN'&#xA;    &#xA;    UPDATE _ETL_Inventory&#xA;    SET TechDepartmentUID = tblTechDepartments.TechDepartmentUID&#xA;    FROM _ETL_Inventory AS Tags&#xA;    JOIN tblTechDepartments ON Tags.Department = tblTechDepartments.DepartmentName&#xA;    WHERE Tags.TechDepartmentUID IS NULL&#xA;    OR (Tags.TechDepartmentUID &gt; 0&#xA;    AND Tags.TechDepartmentUID &lt;&gt; tblTechDepartments.TechDepartmentUID)&#xA;    &#xA;    UPDATE _ETL_Inventory&#xA;    SET TechDepartmentUID = 0&#xA;    WHERE TechDepartmentUID IS NULL&#xA;&#xA;    INSERT INTO tblTechInventory (InventorySourceUID, ItemUID, SiteUID, EntityUID, EntityTypeUID,&#xA;    StatusUID, TechDepartmentUID, Tag, Serial,&#xA;    FundingSourceUID, PurchasePrice, PurchaseDate, ExpirationDate, InventoryNotes,&#xA;    CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate, AssetID, InventoryTypeUID)&#xA;    SELECT CASE WHEN Tags.PurchaseUID = 0 THEN 1 ELSE 2 END,&#xA;    Tags.ItemUID, Tags.SiteUID, Tags.EntityUID, Tags.EntityTypeUID,&#xA;    Tags.StatusID, Tags.TechDepartmentUID, Tags.Tag, Tags.Serial,&#xA;    Tags.FundingSourceUID, Tags.PurchasePrice, Tags.PurchaseDate,&#xA;    Tags.ExpirationDate, Tags.InventoryNotes, 0, GETDATE(), 0, GETDATE(), Tags.AssetID, 1&#xA;    FROM _ETL_Inventory AS Tags&#xA;    WHERE Tags.ItemUID &gt; 0&#xA;    AND Tags.SiteUID &gt; 1&#xA;    AND Tags.EntityUID &gt; 0&#xA;    AND Tags.InventoryUID IS NULL&#xA;&#x9;and Tags.AssetID not in (select AssetID from tblTechInventory)&#xA;&#x9;and Tags.Tag not in (select Tag from tblTechInventory)&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET InventoryUID = tblTechInventory.InventoryUID&#xA;    FROM _ETL_Inventory AS Tags&#xA;    JOIN tblTechInventory ON Tags.AssetID = tblTechInventory.AssetID&#xA;    WHERE Tags.InventoryUID IS NULL&#xA;    OR (Tags.InventoryUID &gt; 0&#xA;    AND Tags.InventoryUID &lt;&gt; tblTechInventory.InventoryUID)&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET InventoryUID = 0&#xA;    WHERE InventoryUID IS NULL&#xA;&#xA;    INSERT INTO tblTechInventoryHistory (InventoryUID, InventoryTypeUID, InventorySourceUID,&#xA;    SiteUID, EntityUID, EntityTypeUID, StatusUID,&#xA;    OriginSiteUID, OriginStatusUID, OriginEntityUID, OriginEntityTypeUID,&#xA;    InventoryHistoryNotes, CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;    SELECT tblTechInventory.InventoryUID, tblTechInventory.InventoryTypeUID, tblTechInventory.InventorySourceUID,&#xA;    tblTechInventory.SiteUID, tblTechInventory.EntityUID, tblTechInventory.EntityTypeUID, tblTechInventory.StatusUID,&#xA;    tblTechInventory.SiteUID, tblTechInventory.StatusUID, tblTechInventory.EntityUID, tblTechInventory.EntityTypeUID,&#xA;    'INTEGRATION IMPORT ' + CONVERT(NVARCHAR(10), GETDATE(), 120), 0, GETDATE(), 0, GETDATE()&#xA;    FROM tblTechInventory&#xA;    LEFT JOIN tblTechInventoryHistory ON tblTechInventory.InventoryUID = tblTechInventoryHistory.InventoryUID&#xA;    WHERE tblTechInventoryHistory.InventoryHistoryUID IS NULL" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\16 -Custom Field Insert- Opt 7-14 - Not Used"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:Disabled="True"
      DTS:DTSID="{CE7D051E-8452-4060-A3BE-A69C95DE0A91}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="16 -Custom Field Insert- Opt 7-14 - Not Used"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="DECLARE @Label VARCHAR(50)&#xA;DECLARE @Type VARCHAR(50)&#xA;&#xA;IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 7 AND ETLSettingValue &lt;&gt; '') = 1&#xA;&#x9;BEGIN&#xA;&#x9;&#x9;SELECT @Label = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 7&#xA;&#x9;&#x9;SELECT @Type = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 8&#xA;&#x9;&#x9;INSERT INTO tblTechInventoryMeta (ItemTypeUID, InventoryMetaLabel,&#xA;&#x9;&#x9;InventoryMetaType, InventoryMetaRequired, InventoryMetaOrder)&#xA;&#x9;&#x9;SELECT Tags.ItemTypeUID, @Label, @Type, 0, 1&#xA;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;LEFT JOIN tblTechInventoryMeta ON Tags.ItemTypeUID = tblTechInventoryMeta.ItemTypeUID&#xA;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaOrder = 1&#xA;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaUID IS NULL&#xA;&#x9;&#x9;GROUP BY Tags.ItemTypeUID&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;SET InventoryMeta1UID = tblTechInventoryMeta.InventoryMetaUID&#xA;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;JOIN tblTechInventoryMeta ON Tags.ItemTypeUID = tblTechInventoryMeta.ItemTypeUID&#xA;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaOrder = 1&#xA;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;AND (Tags.InventoryMeta1UID IS NULL&#xA;&#x9;&#x9;OR Tags.InventoryMeta1UID &lt;&gt; tblTechInventoryMeta.InventoryMetaUID)&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;SET InventoryMeta1UID = 0&#xA;&#x9;&#x9;WHERE InventoryMeta1UID IS NULL&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;INSERT INTO tblTechInventoryExt (InventoryUID, InventoryMetaUID, InventoryExtValue)&#xA;&#x9;&#x9;SELECT Tags.InventoryUID, Tags.InventoryMeta1UID, Tags.CustomField1&#xA;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;LEFT JOIN tblTechInventoryExt ON Tags.InventoryUID = tblTechInventoryExt.InventoryUID&#xA;&#x9;&#x9;AND Tags.InventoryMeta1UID = tblTechInventoryExt.InventoryMetaUID&#xA;&#x9;&#x9;WHERE Tags.InventoryUID &gt; 0&#xA;&#x9;&#x9;AND Tags.InventoryMeta1UID &gt; 0&#xA;&#x9;&#x9;AND tblTechInventoryExt.InventoryExtUID IS NULL&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;SET InventoryExt1UID = tblTechInventoryExt.InventoryExtUID&#xA;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;JOIN tblTechInventoryExt ON Tags.InventoryMeta1UID = tblTechInventoryExt.InventoryMetaUID&#xA;&#x9;&#x9;AND Tags.InventoryUID = tblTechInventoryExt.InventoryUID&#xA;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;AND (Tags.InventoryExt1UID IS NULL&#xA;&#x9;&#x9;OR Tags.InventoryExt1UID &lt;&gt; tblTechInventoryExt.InventoryExtUID)&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;SET InventoryExt1UID = 0&#xA;&#x9;&#x9;WHERE InventoryExt1UID IS NULL&#xA;&#x9;END&#xA;&#xA;IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 9 AND ETLSettingValue &lt;&gt; '') = 1&#xA;&#x9;BEGIN&#xA;&#x9;&#x9;SELECT @Label = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 9&#xA;&#x9;&#x9;SELECT @Type = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 10&#xA;&#x9;&#x9;INSERT INTO tblTechInventoryMeta (ItemTypeUID, InventoryMetaLabel,&#xA;&#x9;&#x9;InventoryMetaType, InventoryMetaRequired, InventoryMetaOrder)&#xA;&#x9;&#x9;SELECT Tags.ItemTypeUID, @Label, @Type, 0, 2&#xA;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;LEFT JOIN tblTechInventoryMeta ON Tags.ItemTypeUID = tblTechInventoryMeta.ItemTypeUID&#xA;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaOrder = 2&#xA;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaUID IS NULL&#xA;&#x9;&#x9;GROUP BY Tags.ItemTypeUID&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;SET InventoryMeta2UID = tblTechInventoryMeta.InventoryMetaUID&#xA;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;JOIN tblTechInventoryMeta ON Tags.ItemTypeUID = tblTechInventoryMeta.ItemTypeUID&#xA;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaOrder = 2&#xA;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;AND (Tags.InventoryMeta2UID IS NULL&#xA;&#x9;&#x9;OR Tags.InventoryMeta2UID &lt;&gt; tblTechInventoryMeta.InventoryMetaUID)&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;SET InventoryMeta2UID = 0&#xA;&#x9;&#x9;WHERE InventoryMeta1UID IS NULL&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;INSERT INTO tblTechInventoryExt (InventoryUID, InventoryMetaUID, InventoryExtValue)&#xA;&#x9;&#x9;SELECT Tags.InventoryUID, Tags.InventoryMeta2UID, Tags.CustomField2&#xA;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;LEFT JOIN tblTechInventoryExt ON Tags.InventoryUID = tblTechInventoryExt.InventoryUID&#xA;&#x9;&#x9;AND Tags.InventoryMeta2UID = tblTechInventoryExt.InventoryMetaUID&#xA;&#x9;&#x9;WHERE Tags.InventoryUID &gt; 0&#xA;&#x9;&#x9;AND Tags.InventoryMeta2UID &gt; 0&#xA;&#x9;&#x9;AND tblTechInventoryExt.InventoryExtUID IS NULL&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;SET InventoryExt2UID = tblTechInventoryExt.InventoryExtUID&#xA;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;JOIN tblTechInventoryExt ON Tags.InventoryMeta2UID = tblTechInventoryExt.InventoryMetaUID&#xA;&#x9;&#x9;AND Tags.InventoryUID = tblTechInventoryExt.InventoryUID&#xA;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;AND (Tags.InventoryExt2UID IS NULL&#xA;&#x9;&#x9;OR Tags.InventoryExt2UID &lt;&gt; tblTechInventoryExt.InventoryExtUID)&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;SET InventoryExt2UID = 0&#xA;&#x9;&#x9;WHERE InventoryExt2UID IS NULL&#xA;&#x9;END&#xA;&#xA;IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 11 AND ETLSettingValue &lt;&gt; '') = 1&#xA;&#x9;BEGIN&#xA;&#x9;&#x9;SELECT @Label = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 11&#xA;&#x9;&#x9;SELECT @Type = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 12&#xA;&#x9;&#x9;INSERT INTO tblTechInventoryMeta (ItemTypeUID, InventoryMetaLabel,&#xA;&#x9;&#x9;InventoryMetaType, InventoryMetaRequired, InventoryMetaOrder)&#xA;&#x9;&#x9;SELECT Tags.ItemTypeUID, @Label, @Type, 0, 3&#xA;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;LEFT JOIN tblTechInventoryMeta ON Tags.ItemTypeUID = tblTechInventoryMeta.ItemTypeUID&#xA;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaOrder = 3&#xA;&#x9;&#x9;WHERE Tags.ItemTypeUID IS NOT NULL&#xA;&#x9;&#x9;AND Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaUID IS NULL&#xA;&#x9;&#x9;GROUP BY Tags.ItemTypeUID&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;SET InventoryMeta3UID = tblTechInventoryMeta.InventoryMetaUID&#xA;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;JOIN tblTechInventoryMeta ON Tags.ItemTypeUID = tblTechInventoryMeta.ItemTypeUID&#xA;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaOrder = 3&#xA;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;AND (Tags.InventoryMeta3UID IS NULL&#xA;&#x9;&#x9;OR Tags.InventoryMeta3UID &lt;&gt; tblTechInventoryMeta.InventoryMetaUID)&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;SET InventoryMeta3UID = 0&#xA;&#x9;&#x9;WHERE InventoryMeta3UID IS NULL&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;INSERT INTO tblTechInventoryExt (InventoryUID, InventoryMetaUID, InventoryExtValue)&#xA;&#x9;&#x9;SELECT Tags.InventoryUID, Tags.InventoryMeta3UID, Tags.CustomField3&#xA;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;LEFT JOIN tblTechInventoryExt ON Tags.InventoryUID = tblTechInventoryExt.InventoryUID&#xA;&#x9;&#x9;AND Tags.InventoryMeta3UID = tblTechInventoryExt.InventoryMetaUID&#xA;&#x9;&#x9;WHERE Tags.InventoryUID &gt; 0&#xA;&#x9;&#x9;AND Tags.InventoryMeta3UID &gt; 0&#xA;&#x9;&#x9;AND tblTechInventoryExt.InventoryExtUID IS NULL&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;SET InventoryExt3UID = tblTechInventoryExt.InventoryExtUID&#xA;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;JOIN tblTechInventoryExt ON Tags.InventoryMeta3UID = tblTechInventoryExt.InventoryMetaUID&#xA;&#x9;&#x9;AND Tags.InventoryUID = tblTechInventoryExt.InventoryUID&#xA;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;AND (Tags.InventoryExt3UID IS NULL&#xA;&#x9;&#x9;OR Tags.InventoryExt3UID &lt;&gt; tblTechInventoryExt.InventoryExtUID)&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;SET InventoryExt3UID = 0&#xA;&#x9;&#x9;WHERE InventoryExt3UID IS NULL&#xA;&#x9;END&#xA;&#xA;IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 13 AND ETLSettingValue &lt;&gt; '') = 1&#xA;&#x9;BEGIN&#xA;&#x9;&#x9;SELECT @Label = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 13&#xA;&#x9;&#x9;SELECT @Type = ETLSettingValue FROM _ETL_Settings WHERE ETLSettingUID = 14&#xA;&#x9;&#x9;INSERT INTO tblTechInventoryMeta (ItemTypeUID, InventoryMetaLabel,&#xA;&#x9;&#x9;InventoryMetaType, InventoryMetaRequired, InventoryMetaOrder)&#xA;&#x9;&#x9;SELECT Tags.ItemTypeUID, @Label, @Type, 0, 4&#xA;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;LEFT JOIN tblTechInventoryMeta ON Tags.ItemTypeUID = tblTechInventoryMeta.ItemTypeUID&#xA;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaOrder = 4&#xA;&#x9;&#x9;WHERE Tags.ItemTypeUID IS NOT NULL&#xA;&#x9;&#x9;AND Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaUID IS NULL&#xA;&#x9;&#x9;GROUP BY Tags.ItemTypeUID&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;SET InventoryMeta4UID = tblTechInventoryMeta.InventoryMetaUID&#xA;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;JOIN tblTechInventoryMeta ON Tags.ItemTypeUID = tblTechInventoryMeta.ItemTypeUID&#xA;&#x9;&#x9;AND tblTechInventoryMeta.InventoryMetaOrder = 4&#xA;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;AND (Tags.InventoryMeta4UID IS NULL&#xA;&#x9;&#x9;OR Tags.InventoryMeta4UID &lt;&gt; tblTechInventoryMeta.InventoryMetaUID)&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;SET InventoryMeta4UID = 0&#xA;&#x9;&#x9;WHERE InventoryMeta4UID IS NULL&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;INSERT INTO tblTechInventoryExt (InventoryUID, InventoryMetaUID, InventoryExtValue)&#xA;&#x9;&#x9;SELECT Tags.InventoryUID, Tags.InventoryMeta4UID, Tags.CustomField4&#xA;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;LEFT JOIN tblTechInventoryExt ON Tags.InventoryUID = tblTechInventoryExt.InventoryUID&#xA;&#x9;&#x9;AND Tags.InventoryMeta4UID = tblTechInventoryExt.InventoryMetaUID&#xA;&#x9;&#x9;WHERE Tags.InventoryUID &gt; 0&#xA;&#x9;&#x9;AND Tags.InventoryMeta4UID &gt; 0&#xA;&#x9;&#x9;AND tblTechInventoryExt.InventoryExtUID IS NULL&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;SET InventoryExt4UID = tblTechInventoryExt.InventoryExtUID&#xA;&#x9;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;&#x9;JOIN tblTechInventoryExt ON Tags.InventoryMeta4UID = tblTechInventoryExt.InventoryMetaUID&#xA;&#x9;&#x9;AND Tags.InventoryUID = tblTechInventoryExt.InventoryUID&#xA;&#x9;&#x9;WHERE Tags.ItemTypeUID &gt; 0&#xA;&#x9;&#x9;AND (Tags.InventoryExt4UID IS NULL&#xA;&#x9;&#x9;OR Tags.InventoryExt4UID &lt;&gt; tblTechInventoryExt.InventoryExtUID)&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;&#x9;SET InventoryExt4UID = 0&#xA;&#x9;&#x9;WHERE InventoryExt4UID IS NULL&#xA;&#x9;END&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\17 - Inventory Purchase Details Update"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:Disabled="True"
      DTS:DTSID="{5E5F8B77-0D8A-416E-9EE2-09B466EE7768}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="17 - Inventory Purchase Details Update"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="    SET NOCOUNT ON;&#xA;    UPDATE _ETL_Inventory&#xA;    SET AccountCode = ''&#xA;    WHERE AccountCode IS NULL&#xA;    OR AccountCode = 'N/A'&#xA;    OR AccountCode = 'NONE'&#xA;    OR AccountCode = 'UNKNOWN'&#xA;&#xA;    UPDATE _ETL_Purchases&#xA;    SET AccountCode = ''&#xA;    WHERE AccountCode IS NULL&#xA;    OR AccountCode = 'N/A'&#xA;    OR AccountCode = 'NONE'&#xA;    OR AccountCode = 'UNKNOWN'&#xA;    &#xA;    UPDATE Tags&#xA;    SET Tags.AccountCode = LTRIM(RTRIM(Purchases.AccountCode))&#xA;    FROM _ETL_Inventory Tags&#xA;    LEFT JOIN (SELECT PurchaseItemDetailUID, MAX(AccountCode) AS AccountCode&#xA;    FROM _ETL_Purchases&#xA;    GROUP BY PurchaseItemDetailUID) AS Purchases ON Tags.PurchaseItemDetailUID = Purchases.PurchaseItemDetailUID&#xA;    WHERE LTRIM(RTRIM(ISNULL(Purchases.AccountCode, ''))) &lt;&gt; ''&#xA;    AND (Tags.AccountCode IS NULL&#xA;    OR Tags.AccountCode &lt;&gt; LTRIM(RTRIM(Purchases.AccountCode)))&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET PurchaseItemDetailUID = Purchases.PurchaseItemDetailUID&#xA;    FROM _ETL_Inventory AS Tags&#xA;    JOIN (SELECT PurchaseUID, ItemUID, FundingSourceUID, PurchasePrice,&#xA;    AccountCode, MIN(PurchaseItemDetailUID) AS PurchaseItemDetailUID&#xA;    FROM _ETL_Purchases&#xA;    GROUP BY PurchaseUID, ItemUID, FundingSourceUID,&#xA;    PurchasePrice, AccountCode) AS Purchases&#xA;    ON Tags.PurchaseUID = Purchases.PurchaseUID&#xA;    AND Tags.ItemUID = Purchases.ItemUID&#xA;    AND Tags.FundingSourceUID = Purchases.FundingSourceUID&#xA;    AND Tags.PurchasePrice = Purchases.PurchasePrice&#xA;    AND Tags.AccountCode = Purchases.AccountCode&#xA;    WHERE Purchases.ItemUID &gt; 0&#xA;    AND (Tags.PurchaseItemDetailUID IS NULL&#xA;    OR Tags.PurchaseItemDetailUID &lt;&gt; Purchases.PurchaseItemDetailUID)&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET PurchaseItemDetailUID = Purchases.PurchaseItemDetailUID&#xA;    FROM _ETL_Inventory AS Tags&#xA;    JOIN (SELECT PurchaseUID, ItemUID, FundingSourceUID, PurchasePrice,&#xA;    AccountCode, MIN(PurchaseItemDetailUID) AS PurchaseItemDetailUID&#xA;    FROM tblTechPurchaseItemDetails&#xA;    GROUP BY PurchaseUID, ItemUID, FundingSourceUID,&#xA;    PurchasePrice, AccountCode) AS Purchases&#xA;    ON Tags.PurchaseUID = Purchases.PurchaseUID&#xA;    AND Tags.ItemUID = Purchases.ItemUID&#xA;    AND Tags.FundingSourceUID = Purchases.FundingSourceUID&#xA;    AND Tags.PurchasePrice = Purchases.PurchasePrice&#xA;    AND Tags.AccountCode = Purchases.AccountCode&#xA;    WHERE (Tags.PurchaseItemDetailUID IS NULL&#xA;    OR Tags.PurchaseItemDetailUID &lt;&gt; Purchases.PurchaseItemDetailUID)&#xA;&#xA;    UPDATE tblTechPurchaseItemDetails&#xA;    SET QuantityOrdered = ISNULL(Tags.c, 0),&#xA;    LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;    FROM tblTechPurchaseItemDetails AS TPID&#xA;    JOIN (SELECT COUNT(*) AS c, PurchaseItemDetailUID&#xA;    FROM _ETL_Inventory&#xA;    GROUP BY PurchaseItemDetailUID) AS Tags&#xA;    ON TPID.PurchaseItemDetailUID = Tags.PurchaseItemDetailUID&#xA;    WHERE TPID.QuantityOrdered &lt; ISNULL(Tags.c, 0)&#xA;&#xA;    UPDATE tblTechPurchaseItemDetails&#xA;    SET QuantityReceived = ISNULL(Tags.c, 0),&#xA;    LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;    FROM tblTechPurchaseItemDetails AS TPID&#xA;    JOIN (SELECT COUNT(*) AS c, PurchaseItemDetailUID&#xA;    FROM _ETL_Inventory&#xA;    GROUP BY PurchaseItemDetailUID) AS Tags&#xA;    ON TPID.PurchaseItemDetailUID = Tags.PurchaseItemDetailUID&#xA;    WHERE TPID.QuantityReceived &lt; ISNULL(Tags.c, 0)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\17 -Purchase Items- Opt 1 - Not Used"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:Disabled="True"
      DTS:DTSID="{27EB595E-CF27-43FB-9F26-2C707CFFBED5}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="17 -Purchase Items- Opt 1 - Not Used"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource=" SET NOCOUNT ON;&#xA;&#x9;UPDATE _ETL_Purchases&#xA;&#x9;SET Manufacturer = ''&#xA;&#x9;WHERE Manufacturer IS NULL&#xA;&#x9;OR Manufacturer = 'N/A'&#xA;&#x9;OR Manufacturer = 'NONE'&#xA;&#x9;OR Manufacturer = 'UNKNOWN'&#xA;&#xA;    IF (@POImport = 1)&#xA;        BEGIN&#xA;            UPDATE _ETL_Purchases&#xA;            SET ItemUID = Items.ItemUID&#xA;            FROM _ETL_Purchases AS Purchases&#xA;            JOIN tblTechItems Items ON UPPER(Purchases.Product) = UPPER(Items.ItemNumber)&#xA;            WHERE Purchases.Product IS NOT NULL AND Purchases.Product &lt;&gt; ''&#xA;            AND Purchases.Product &lt;&gt; 'N/A' AND Purchases.Product &lt;&gt; 'NONE' AND Purchases.Product &lt;&gt; 'UNKNOWN'&#xA;            AND Purchases.ProductByNumber = 1&#xA;            AND (Purchases.ItemUID IS NULL&#xA;            OR Purchases.ItemUID &lt;&gt; Items.ItemUID)&#xA;&#xA;            UPDATE _ETL_Purchases&#xA;            SET ItemUID = Items.ItemUID&#xA;            FROM _ETL_Purchases AS Purchases&#xA;            JOIN tblTechItems Items ON UPPER(Purchases.Product) = UPPER(Items.ItemName)&#xA;            WHERE Purchases.Product IS NOT NULL AND Purchases.Product &lt;&gt; ''&#xA;            AND Purchases.Product &lt;&gt; 'N/A' AND Purchases.Product &lt;&gt; 'NONE' AND Purchases.Product &lt;&gt; 'UNKNOWN'&#xA;            AND Purchases.ProductByNumber = 0&#xA;            AND (Purchases.ItemUID IS NULL&#xA;            OR Purchases.ItemUID &lt;&gt; Items.ItemUID)&#xA;        END&#xA;    ELSE&#xA;        BEGIN&#xA;            IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 1 AND ETLSettingValue = 'ProductNumber') = 0&#xA;                BEGIN&#xA;                    UPDATE _ETL_Purchases&#xA;                    SET ItemUID = _ETL_Items.ItemUID&#xA;                    FROM _ETL_Purchases AS Purchases&#xA;                    JOIN _ETL_Items ON UPPER(Purchases.Product) = UPPER(_ETL_Items.Product)&#xA;                    AND UPPER(ISNULL(Purchases.Model, '')) = UPPER(ISNULL(_ETL_Items.Model, ''))&#xA;                    AND UPPER(ISNULL(Purchases.Manufacturer, '')) = UPPER(ISNULL(_ETL_Items.Manufacturer, ''))&#xA;                    AND UPPER(ISNULL(Purchases.Area, '')) = UPPER(ISNULL(_ETL_Items.Area, ''))&#xA;                    WHERE Purchases.Product IS NOT NULL AND Purchases.Product &lt;&gt; ''&#xA;                    AND Purchases.Product &lt;&gt; 'N/A' AND Purchases.Product &lt;&gt; 'NONE' AND Purchases.Product &lt;&gt; 'UNKNOWN'&#xA;                    AND (Purchases.ItemUID IS NULL&#xA;                    OR Purchases.ItemUID &lt;&gt; _ETL_Items.ItemUID)&#xA;&#xA;                    UPDATE _ETL_Purchases&#xA;                    SET ItemUID = Items.ItemUID&#xA;                    FROM _ETL_Purchases AS Purchases&#xA;                    JOIN (SELECT ItemUID, ItemName, ModelNumber, ManufacturerName, AreaName&#xA;                    FROM tblTechItems I&#xA;                    JOIN tblUnvManufacturers M ON I.ManufacturerUID = M.ManufacturerUID&#xA;                    JOIN tblUnvAreas A ON I.AreaUID = A.AreaUID) AS Items&#xA;                    ON UPPER(Purchases.Product) = UPPER(Items.ItemName)&#xA;                    AND UPPER(ISNULL(Purchases.Model, '')) = UPPER(ISNULL(Items.ModelNumber, ''))&#xA;                    AND UPPER(ISNULL(Purchases.Manufacturer, '')) = UPPER(ISNULL(Items.ManufacturerName, ''))&#xA;                    AND UPPER(ISNULL(Purchases.Area, '')) = UPPER(ISNULL(Items.AreaName, ''))&#xA;                    WHERE Purchases.Product IS NOT NULL AND Purchases.Product &lt;&gt; ''&#xA;                    AND Purchases.Product &lt;&gt; 'N/A' AND Purchases.Product &lt;&gt; 'NONE' AND Purchases.Product &lt;&gt; 'UNKNOWN'&#xA;                    AND (Purchases.ItemUID IS NULL)&#xA;                END&#xA;            ELSE&#xA;                BEGIN&#xA;                    UPDATE _ETL_Purchases&#xA;                    SET ItemUID = _ETL_Items.ItemUID&#xA;                    FROM _ETL_Purchases AS Purchases&#xA;                    JOIN _ETL_Items ON UPPER(Purchases.Product) = UPPER(_ETL_Items.Product)&#xA;                    WHERE Purchases.Product IS NOT NULL AND Purchases.Product &lt;&gt; ''&#xA;                    AND Purchases.Product &lt;&gt; 'N/A' AND Purchases.Product &lt;&gt; 'NONE' AND Purchases.Product &lt;&gt; 'UNKNOWN'&#xA;                    AND (Purchases.ItemUID IS NULL&#xA;                    OR Purchases.ItemUID &lt;&gt; _ETL_Items.ItemUID)&#xA;&#xA;                    UPDATE _ETL_Purchases&#xA;                    SET ItemUID = tblTechItems.ItemUID&#xA;                    FROM _ETL_Purchases AS Purchases&#xA;                    JOIN tblTechItems ON UPPER(Purchases.Product) = UPPER(tblTechItems.ItemNumber)&#xA;                    WHERE Purchases.Product IS NOT NULL AND Purchases.Product &lt;&gt; ''&#xA;                    AND Purchases.Product &lt;&gt; 'N/A' AND Purchases.Product &lt;&gt; 'NONE' AND Purchases.Product &lt;&gt; 'UNKNOWN'&#xA;                    AND (Purchases.ItemUID IS NULL)&#xA;                END&#xA;        END&#xA;&#xA;    UPDATE _ETL_Purchases&#xA;    SET ItemUID = 0&#xA;    WHERE ItemUID IS NULL" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\20 - Inventory Purchase Details Insert - Opt 17"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:Disabled="True"
      DTS:DTSID="{B542125B-2BA5-489C-B0AF-CFB1FEAD8946}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="20 - Inventory Purchase Details Insert - Opt 17"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource=" --20&#xA;    SET NOCOUNT ON;&#xA;    UPDATE _ETL_Inventory&#xA;    SET AccountCode = ''&#xA;    WHERE LTRIM(RTRIM(ISNULL(AccountCode, ''))) = ''&#xA;&#xA;    UPDATE tblTechPurchaseItemDetails&#xA;    SET AccountCode = ''&#xA;    WHERE LTRIM(RTRIM(ISNULL(AccountCode, ''))) = ''&#xA;&#xA;    IF (SELECT COUNT(*) FROM _ETL_Settings WHERE ETLSettingUID = 17 AND ETLSettingValue = 'True') = 0 --Eval true&#xA;    BEGIN&#xA;        INSERT INTO tblTechPurchaseItemDetails (PurchaseUID, ItemUID, FundingSourceUID,&#xA;        StatusUID, SiteAddedSiteUID, QuantityOrdered, QuantityReceived,&#xA;        PurchasePrice, AccountCode, TechDepartmentUID,&#xA;        CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;        SELECT Tags.PurchaseUID, Tags.ItemUID, Tags.FundingSourceUID,&#xA;        33, 1, Tags.Quantity, Tags.Quantity,&#xA;        Tags.PurchasePrice, Tags.AccountCode, Tags.TechDepartmentUID,&#xA;        0, GETDATE(), 0, GETDATE()&#xA;        FROM (SELECT PurchaseUID, ItemUID, FundingSourceUID,&#xA;        COUNT(*) AS Quantity, PurchasePrice, AccountCode,&#xA;        MAX(ISNULL(TechDepartmentUID, 0)) AS TechDepartmentUID&#xA;        FROM _ETL_Inventory&#xA;        WHERE ItemUID &gt; 0&#xA;        AND InventoryUID &gt; 0&#xA;        AND SiteUID &gt; 0&#xA;        AND PurchaseUID &gt; 0&#xA;        AND (PurchaseItemDetailUID IS NULL&#xA;        OR PurchaseItemDetailUID = 0)&#xA;        GROUP BY PurchaseUID, ItemUID, FundingSourceUID,&#xA;        PurchasePrice, AccountCode) AS Tags&#xA;    END&#xA;&#xA;    UPDATE tblTechPurchaseItemDetails&#xA;    SET QuantityOrdered = QuantityReceived&#xA;    WHERE QuantityReceived &gt; QuantityOrdered&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET PurchaseItemDetailUID = PID.PurchaseItemDetailUID&#xA;    FROM _ETL_Inventory AS Tags&#xA;    JOIN (SELECT MAX(PurchaseItemDetailUID) AS PurchaseItemDetailUID,&#xA;    PurchaseUID, ItemUID, FundingSourceUID, PurchasePrice, AccountCode&#xA;    FROM tblTechPurchaseItemDetails&#xA;    GROUP BY PurchaseUID, ItemUID, FundingSourceUID, PurchasePrice,&#xA;    AccountCode) AS PID ON Tags.PurchaseUID = PID.PurchaseUID&#xA;    AND Tags.ItemUID = PID.ItemUID&#xA;    AND Tags.FundingSourceUID = PID.FundingSourceUID&#xA;    AND Tags.PurchasePrice = PID.PurchasePrice&#xA;    AND Tags.AccountCode = PID.AccountCode&#xA;    WHERE Tags.InventoryUID &gt; 0&#xA;    AND Tags.SiteUID &gt; 0&#xA;    AND (Tags.PurchaseItemDetailUID IS NULL&#xA;    OR Tags.PurchaseItemDetailUID &lt;&gt; PID.PurchaseItemDetailUID)&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET PurchaseItemDetailUID = 0&#xA;    WHERE PurchaseItemDetailUID IS NULL" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\21 -Purchase Shipments - Not Used"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:Disabled="True"
      DTS:DTSID="{8B655A6A-19D1-4AB9-A5A3-4BD410ECAC26}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="21 -Purchase Shipments - Not Used"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="&#x9;SET NOCOUNT ON;&#xA;&#x9;UPDATE tblTechPurchaseItemShipments&#xA;&#x9;SET TicketNumber = ''&#xA;&#x9;WHERE TicketNumber IS NULL&#xA;&#xA;&#x9;UPDATE _ETL_Purchases&#xA;&#x9;SET TicketNumber = ''&#xA;&#x9;WHERE TicketNumber IS NULL&#xA;&#xA;&#x9;UPDATE _ETL_Purchases&#xA;&#x9;SET TicketedByUserID = tblUser.UserID&#xA;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;JOIN tblUser ON UPPER(Purchases.TicketedBy) = UPPER(tblUser.RealName)&#xA;&#x9;AND tblUser.ApplicationUID = 2&#xA;&#x9;WHERE Purchases.TicketedBy IS NOT NULL AND Purchases.TicketedBy &lt;&gt; ''&#xA;&#x9;AND Purchases.TicketedBy &lt;&gt; 'N/A' AND Purchases.TicketedBy &lt;&gt; 'NONE' AND Purchases.TicketedBy &lt;&gt; 'UNKNOWN'&#xA;&#x9;AND (Purchases.TicketedByUserID IS NULL&#xA;&#x9;OR Purchases.TicketedByUserID &lt;&gt; tblUser.UserID)&#xA;&#xA;&#x9;UPDATE _ETL_Purchases&#xA;&#x9;SET TicketedByUserID = 0&#xA;&#x9;WHERE TicketedByUserID IS NULL&#xA;&#xA;&#x9;UPDATE tblTechPurchaseItemShipments&#xA;&#x9;SET QuantityShipped = ISNULL(Tags.c, 0), LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;&#x9;FROM tblTechPurchaseItemShipments AS TPIS&#xA;&#x9;JOIN (SELECT COUNT(*) AS c, PurchaseItemShipmentUID&#xA;&#x9;FROM _ETL_Inventory&#xA;&#x9;GROUP BY PurchaseItemShipmentUID) AS Tags&#xA;&#x9;ON TPIS.PurchaseItemShipmentUID = Tags.PurchaseItemShipmentUID&#xA;&#x9;JOIN tblTechPurchaseItemDetails ON TPIS.PurchaseItemDetailUID = tblTechPurchaseItemDetails.PurchaseItemDetailUID&#xA;&#x9;WHERE TPIS.QuantityShipped &lt; ISNULL(Tags.c, 0)&#xA;&#xA;&#x9;INSERT INTO tblTechPurchaseItemShipments (PurchaseItemDetailUID, ShippedToSiteUID, TicketNumber, QuantityShipped,&#xA;&#x9;TicketedByUserID, TicketedDate, StatusUID, CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#x9;SELECT Purchases.PurchaseItemDetailUID, Purchases.ShippedToSiteUID, Purchases.TicketNumber, MAX(ISNULL(Purchases.QuantityShipped, 0)),&#xA;&#x9;MAX(Purchases.TicketedByUserID), MIN(ISNULL(Purchases.TicketedDate, GETDATE())), 58, 0, GETDATE(), 0, GETDATE()&#xA;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;LEFT JOIN tblTechPurchaseItemShipments ON Purchases.PurchaseItemDetailUID = tblTechPurchaseItemShipments.PurchaseItemDetailUID&#xA;&#x9;AND Purchases.ShippedToSiteUID = tblTechPurchaseItemShipments.ShippedToSiteUID&#xA;&#x9;AND Purchases.TicketNumber = tblTechPurchaseItemShipments.TicketNumber&#xA;&#x9;WHERE Purchases.PurchaseItemDetailUID &gt; 0&#xA;&#x9;AND Purchases.ShippedToSiteUID &gt; 0&#xA;&#x9;AND Purchases.PurchaseItemShipmentUID IS NULL&#xA;&#x9;AND tblTechPurchaseItemShipments.PurchaseItemShipmentUID IS NULL&#xA;&#x9;GROUP BY Purchases.PurchaseItemDetailUID, Purchases.ShippedToSiteUID, Purchases.TicketNumber&#xA;&#xA;&#x9;UPDATE _ETL_Purchases&#xA;&#x9;SET PurchaseItemShipmentUID = tblTechPurchaseItemShipments.PurchaseItemShipmentUID&#xA;&#x9;FROM _ETL_Purchases AS Purchases&#xA;&#x9;JOIN tblTechPurchaseItemShipments ON Purchases.PurchaseItemDetailUID = tblTechPurchaseItemShipments.PurchaseItemDetailUID&#xA;&#x9;AND Purchases.ShippedToSiteUID = tblTechPurchaseItemShipments.ShippedToSiteUID&#xA;&#x9;AND Purchases.TicketNumber = tblTechPurchaseItemShipments.TicketNumber&#xA;&#x9;WHERE Purchases.PurchaseItemShipmentUID IS NULL&#xA;&#x9;OR Purchases.PurchaseItemShipmentUID &lt;&gt; tblTechPurchaseItemShipments.PurchaseItemShipmentUID&#xA;&#xA;&#x9;UPDATE _ETL_Purchases&#xA;&#x9;SET PurchaseItemShipmentUID = 0&#xA;&#x9;WHERE PurchaseItemShipmentUID IS NULL&#xA;&#xA;&#x9;UPDATE tblTechPurchaseItemDetails&#xA;&#x9;SET QuantityReceived = TPIS.Quantity&#xA;&#x9;FROM tblTechPurchaseItemDetails AS TPID&#xA;&#x9;JOIN (SELECT PurchaseItemDetailUID, SUM(QuantityShipped) AS Quantity&#xA;&#x9;FROM tblTechPurchaseItemShipments&#xA;&#x9;GROUP BY PurchaseItemDetailUID) AS TPIS&#xA;&#x9;ON TPID.PurchaseItemDetailUID = TPIS.PurchaseItemDetailUID&#xA;&#x9;WHERE TPIS.Quantity &gt; TPID.QuantityReceived&#xA;&#xA;&#x9;UPDATE tblTechPurchaseItemDetails&#xA;&#x9;SET QuantityOrdered = QuantityReceived&#xA;&#x9;WHERE QuantityReceived &gt; QuantityOrdered&#xA;&#xA;&#x9;UPDATE tblTechPurchaseItemDetails&#xA;&#x9;SET StatusUID = 32&#xA;&#x9;WHERE QuantityOrdered &gt; QuantityReceived&#xA;&#x9;AND StatusUID = 33" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\22 -Inventory Purchase Shipments Update"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{44E653DD-6BB5-4D67-A09F-5EC9BD61A6A9}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="22 -Inventory Purchase Shipments Update"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="--22-&#xA;&#xA;&#x9;SET NOCOUNT ON;&#xA;&#xA;&#x9;--select * &#xA;&#x9;update etl set PurchaseItemShipmentUID = tship.PurchaseItemShipmentUID&#xA;&#x9;FROM _ETL_Inventory etl&#xA;&#x9;join tblTechPurchaseItemDetails tpid on etl.PurchaseItemDetailUID = tpid.PurchaseItemDetailUID&#xA;&#x9;JOIN (SELECT MIN(InventoryHistoryUID) AS InventoryHistoryUID, InventoryUID&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryHistory GROUP BY InventoryUID) AS HistoryJoin &#xA;&#x9;&#x9;&#x9;ON etl.InventoryUID = HistoryJoin.InventoryUID&#xA;&#x9;JOIN tblTechInventoryHistory ttih ON HistoryJoin.InventoryHistoryUID = ttih.InventoryHistoryUID&#xA;&#x9;join tblTechPurchaseItemShipments tship on tship.PurchaseItemDetailUID = tpid.PurchaseItemDetailUID&#xA;&#x9;&#x9;and tship.ShippedToSiteUID = ttih.OriginSiteUID&#xA;&#x9;WHERE etl.PurchaseItemShipmentUID IS NULL&#xA;&#xA;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;SET PurchaseItemShipmentUID = Purchases.PurchaseItemShipmentUID&#xA;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;JOIN (SELECT MIN(InventoryHistoryUID) AS InventoryHistoryUID, InventoryUID&#xA;&#x9;&#x9;&#x9;FROM tblTechInventoryHistory GROUP BY InventoryUID) AS HistoryJoin &#xA;&#x9;&#x9;&#x9;ON Tags.InventoryUID = HistoryJoin.InventoryUID&#xA;&#x9;JOIN tblTechInventoryHistory ttih ON HistoryJoin.InventoryHistoryUID = ttih.InventoryHistoryUID&#xA;&#x9;JOIN _ETL_Purchases AS Purchases on Purchases.PurchaseUID = tags.PurchaseUID&#xA;&#x9;AND tags.SiteUID = Purchases.ShippedToSiteUID&#xA;&#x9;WHERE Tags.PurchaseItemShipmentUID IS NULL&#xA;&#xA;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;SET PurchaseItemShipmentUID = tship.PurchaseItemShipmentUID&#xA;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;JOIN (SELECT MIN(InventoryHistoryUID) AS InventoryHistoryUID, InventoryUID&#xA;&#x9;&#x9;FROM tblTechInventoryHistory GROUP BY InventoryUID) AS HistoryJoin &#xA;&#x9;&#x9;ON Tags.InventoryUID = HistoryJoin.InventoryUID&#xA;&#x9;JOIN tblTechInventoryHistory ttih ON HistoryJoin.InventoryHistoryUID = ttih.InventoryHistoryUID&#xA;&#x9;JOIN tblTechPurchaseItemShipments tship ON Tags.PurchaseItemDetailUID = tship.PurchaseItemDetailUID&#xA;&#x9;AND ttih.SiteUID = tship.ShippedToSiteUID&#xA;&#x9;WHERE Tags.PurchaseItemShipmentUID IS NULL&#xA;&#xA;&#x9;----This info is not relevant to _ETL_Purchases so join is null&#xA;&#x9;--UPDATE _ETL_Inventory&#xA;&#x9;--SET PurchaseItemShipmentUID = Purchases.PurchaseItemShipmentUID&#xA;&#x9;--FROM _ETL_Inventory AS Tags&#xA;&#x9;--JOIN _ETL_Purchases AS Purchases ON Tags.PurchaseItemDetailUID = Purchases.PurchaseItemDetailUID&#xA;&#x9;--AND Tags.SiteUID = Purchases.ShippedToSiteUID&#xA;&#x9;--WHERE Tags.PurchaseItemShipmentUID IS NULL&#xA;&#xA;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;SET PurchaseItemShipmentUID = tship.PurchaseItemShipmentUID&#xA;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;JOIN tblTechPurchaseItemShipments tship ON Tags.PurchaseItemDetailUID = tship.PurchaseItemDetailUID&#xA;&#x9;AND Tags.SiteUID = tship.ShippedToSiteUID&#xA;&#x9;WHERE Tags.PurchaseItemShipmentUID IS NULL&#xA;&#xA;&#x9;UPDATE tblTechPurchaseItemShipments&#xA;&#x9;SET QuantityShipped = ISNULL(Tags.c, 0), LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;&#x9;FROM tblTechPurchaseItemShipments AS TPIS&#xA;&#x9;JOIN (SELECT COUNT(*) AS c, PurchaseItemShipmentUID&#xA;&#x9;FROM _ETL_Inventory&#xA;&#x9;GROUP BY PurchaseItemShipmentUID) AS Tags&#xA;&#x9;ON TPIS.PurchaseItemShipmentUID = Tags.PurchaseItemShipmentUID&#xA;&#x9;JOIN tblTechPurchaseItemDetails tpid ON TPIS.PurchaseItemDetailUID = tpid.PurchaseItemDetailUID&#xA;&#x9;WHERE TPIS.QuantityShipped &lt; ISNULL(Tags.c, 0)&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\23 -Inventory Purchase Shipments Insert"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{F7207D2C-964E-4CC4-A371-CC77E7154CC4}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="23 -Inventory Purchase Shipments Insert"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="--23 &#xA;&#xA;   SET NOCOUNT ON;&#xA;&#xA;   INSERT INTO tblTechPurchaseItemShipments (PurchaseItemDetailUID, ShippedToSiteUID, QuantityShipped,&#xA;   StatusUID, CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;&#xA;&#x9;SELECT Tags.PurchaseItemDetailUID, Tags.SiteUID, COUNT(*),&#xA;    33, 0, GETDATE(), 0, GETDATE()&#xA;    FROM _ETL_Inventory AS Tags&#xA;    WHERE Tags.InventoryUID &gt; 0&#xA;    AND Tags.SiteUID &gt; 0&#xA;    AND Tags.PurchaseUID &gt; 0&#xA;    AND Tags.PurchaseItemDetailUID &gt; 0&#xA;    AND (Tags.PurchaseItemShipmentUID IS NULL&#xA;    OR Tags.PurchaseItemShipmentUID = 0)&#xA;    GROUP BY Tags.PurchaseItemDetailUID, Tags.SiteUID&#xA;&#x9;order by 1&#xA;&#xA;    UPDATE tags    SET PurchaseItemShipmentUID = tship.PurchaseItemShipmentUID&#xA;&#x9;--select *&#xA;    FROM _ETL_Inventory AS Tags&#xA;    JOIN tblTechPurchaseItemShipments tship ON Tags.PurchaseItemDetailUID = tship.PurchaseItemDetailUID&#xA;&#x9;&#x9;AND tags.SiteUID = tship.ShippedToSiteUID&#xA;    WHERE Tags.InventoryUID &gt; 0&#xA;    AND Tags.SiteUID &gt; 0&#xA;    AND isNull(Tags.PurchaseItemShipmentUID, 0) = 0&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET PurchaseItemShipmentUID = 0&#xA;    WHERE PurchaseItemShipmentUID IS NULL&#xA;&#xA;&#x9;UPDATE tblTechPurchaseItemShipments&#xA;&#x9;SET QuantityShipped = ISNULL(Tags.c, 0), LastModifiedByUserID = 0, LastModifiedDate = GETDATE()&#xA;&#x9;FROM tblTechPurchaseItemShipments AS TPIS&#xA;&#x9;JOIN (SELECT COUNT(*) AS c, PurchaseItemShipmentUID&#xA;&#x9;FROM _ETL_Inventory&#xA;&#x9;GROUP BY PurchaseItemShipmentUID) AS Tags&#xA;&#x9;ON TPIS.PurchaseItemShipmentUID = Tags.PurchaseItemShipmentUID&#xA;&#x9;JOIN tblTechPurchaseItemDetails ON TPIS.PurchaseItemDetailUID = tblTechPurchaseItemDetails.PurchaseItemDetailUID&#xA;&#x9;WHERE TPIS.QuantityShipped &lt; ISNULL(Tags.c, 0)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\24 - Inventory Purchase Inventory Update"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{07C5A762-BB1B-45F3-99CD-8804F2907D1C}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="24 - Inventory Purchase Inventory Update"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="&#x9;--24&#xA;&#x9;&#xA;&#x9;SET NOCOUNT ON;&#xA;&#x9;UPDATE _ETL_Inventory&#xA;&#x9;SET PurchaseInventoryUID = tblTechPurchaseInventory.PurchaseInventoryUID&#xA;&#x9;FROM _ETL_Inventory AS Tags&#xA;&#x9;JOIN tblTechPurchaseInventory ON Tags.InventoryUID = tblTechPurchaseInventory.InventoryUID&#xA;&#x9;WHERE Tags.SiteUID &gt; 0&#xA;&#x9;AND Tags.PurchaseInventoryUID IS NULL&#xA;&#xA;&#x9;UPDATE tblTechPurchaseInventory&#xA;&#x9;SET PurchaseItemShipmentUID = Tags.PurchaseItemShipmentUID&#xA;&#x9;FROM tblTechPurchaseInventory AS TPI&#xA;&#x9;JOIN _ETL_Inventory AS Tags ON TPI.PurchaseInventoryUID = Tags.PurchaseInventoryUID&#xA;&#x9;AND Tags.PurchaseItemShipmentUID &gt; 0&#xA;&#x9;AND TPI.PurchaseItemShipmentUID &lt;&gt; Tags.PurchaseItemShipmentUID&#xA;&#xA;&#x9;DELETE old&#xA;&#x9;FROM tblTechPurchaseInventory AS old&#xA;&#x9;JOIN tblTechPurchaseItemShipments tship ON old.PurchaseItemShipmentUID = tship.PurchaseItemShipmentUID&#xA;&#x9;JOIN tblTechPurchaseItemDetails tpid ON tship.PurchaseItemDetailUID = tpid.PurchaseItemDetailUID&#xA;&#x9;JOIN tblTechPurchases ON tpid.PurchaseUID = tblTechPurchases.PurchaseUID&#xA;&#x9;LEFT JOIN _ETL_Inventory AS Tags ON old.PurchaseInventoryUID = Tags.PurchaseInventoryUID&#xA;&#x9;LEFT JOIN tblTechInventory ON old.InventoryUID = tblTechInventory.InventoryUID&#xA;&#x9;AND old.PurchaseItemShipmentUID = Tags.PurchaseItemShipmentUID&#xA;&#x9;WHERE (tblTechPurchases.Notes LIKE '%ASSET DATA IMPORT%' or tblTechPurchases.Notes LIKE '%INTEGRATION DATA IMPORT%')&#xA;&#x9;AND Tags.PurchaseInventoryUID IS NULL&#xA;&#x9;AND tblTechInventory.InventoryUID IS NULL" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\25 - Inventory Purchasing Inventory Insert"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{B0C77476-5C08-47BD-B8A9-1D1794FCFBAB}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="25 - Inventory Purchasing Inventory Insert"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9B8686BF-5739-4CE3-9342-4AC5C80A9BC4}"
          SQLTask:SqlStatementSource="   --25&#xA;   &#xA;    SET NOCOUNT ON;&#xA;&#xA;    INSERT INTO tblTechPurchaseInventory (InventoryUID, PurchaseItemShipmentUID,&#xA;    CreatedByUserID, CreatedDate, LastModifiedByUserID, LastModifiedDate)&#xA;    SELECT Tags.InventoryUID, Tags.PurchaseItemShipmentUID,&#xA;    0, GETDATE(), 0, GETDATE()&#xA;    FROM _ETL_Inventory AS Tags&#xA;    WHERE Tags.InventoryUID &gt; 0&#xA;    AND Tags.SiteUID &gt; 0&#xA;    AND Tags.PurchaseUID &gt; 0&#xA;    AND Tags.PurchaseItemDetailUID &gt; 0&#xA;    AND Tags.PurchaseItemShipmentUID &gt; 0&#xA;    AND (Tags.PurchaseInventoryUID IS NULL&#xA;    OR Tags.PurchaseInventoryUID = 0)&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET PurchaseInventoryUID = tblTechPurchaseInventory.PurchaseInventoryUID&#xA;    FROM _ETL_Inventory AS Tags&#xA;    JOIN tblTechPurchaseInventory ON Tags.InventoryUID = tblTechPurchaseInventory.InventoryUID&#xA;    WHERE Tags.PurchaseInventoryUID IS NULL&#xA;&#xA;    UPDATE _ETL_Inventory&#xA;    SET PurchaseInventoryUID = 0&#xA;    WHERE PurchaseInventoryUID IS NULL&#xA;&#xA;&#xA;&#x9;--UPDATE tblTechInventory&#xA;&#x9;--SET ItemUID = TPID.ItemUID&#xA;&#x9;--FROM tblTechInventory AS Inventory&#xA;&#x9;--JOIN tblTechPurchaseInventory AS TPI ON Inventory.InventoryUID = TPI.InventoryUID&#xA;&#x9;--JOIN tblTechPurchaseItemShipments AS TPIS ON TPI.PurchaseItemShipmentUID = TPIS.PurchaseItemShipmentUID&#xA;&#x9;--JOIN tblTechPurchaseItemDetails AS TPID ON TPIS.PurchaseItemDetailUID = TPID.PurchaseItemDetailUID&#xA;&#x9;--WHERE TPID.ItemUID &gt; 0&#xA;&#x9;--AND Inventory.ItemUID &lt;&gt; TPID.ItemUID&#xA;&#xA;    DELETE old&#xA;    FROM tblTechPurchaseItemShipments AS old&#xA;    JOIN tblTechPurchaseItemDetails ON old.PurchaseItemDetailUID = tblTechPurchaseItemDetails.PurchaseItemDetailUID&#xA;    JOIN tblTechPurchases ON tblTechPurchaseItemDetails.PurchaseUID = tblTechPurchases.PurchaseUID&#xA;    LEFT JOIN (SELECT PurchaseItemShipmentUID FROM _ETL_Inventory&#xA;    GROUP BY PurchaseItemShipmentUID) AS Inv ON old.PurchaseItemShipmentUID = Inv.PurchaseItemShipmentUID&#xA;    LEFT JOIN (SELECT PurchaseItemShipmentUID FROM _ETL_Purchases&#xA;    GROUP BY PurchaseItemShipmentUID) AS Purch ON old.PurchaseItemShipmentUID = Purch.PurchaseItemShipmentUID&#xA;    LEFT JOIN (SELECT PurchaseItemShipmentUID FROM tblTechPurchaseInventory&#xA;    GROUP BY PurchaseItemShipmentUID) AS Tags ON old.PurchaseItemShipmentUID = Tags.PurchaseItemShipmentUID&#xA;    WHERE (tblTechPurchases.Notes LIKE '%ASSET DATA IMPORT%' or tblTechPurchases.Notes LIKE '%INTEGRATION DATA IMPORT%')&#xA;    AND Inv.PurchaseItemShipmentUID IS NULL&#xA;    AND Purch.PurchaseItemShipmentUID IS NULL&#xA;    AND Tags.PurchaseItemShipmentUID IS NULL&#xA;&#xA;    DELETE old&#xA;    FROM tblTechPurchaseItemDetails AS old&#xA;    JOIN tblTechPurchases ON old.PurchaseUID = tblTechPurchases.PurchaseUID&#xA;    LEFT JOIN (SELECT PurchaseItemDetailUID FROM _ETL_Inventory&#xA;    GROUP BY PurchaseItemDetailUID) AS Inv ON old.PurchaseItemDetailUID = Inv.PurchaseItemDetailUID&#xA;    LEFT JOIN (SELECT PurchaseItemDetailUID FROM _ETL_Purchases&#xA;    GROUP BY PurchaseItemDetailUID) AS Purch ON old.PurchaseItemDetailUID = Purch.PurchaseItemDetailUID&#xA;    LEFT JOIN (SELECT PurchaseItemDetailUID FROM tblTechPurchaseItemShipments&#xA;    GROUP BY PurchaseItemDetailUID) AS Tags ON old.PurchaseItemDetailUID = Tags.PurchaseItemDetailUID&#xA;    WHERE (tblTechPurchases.Notes LIKE '%ASSET DATA IMPORT%' or tblTechPurchases.Notes LIKE '%INTEGRATION DATA IMPORT%')&#xA;    AND Inv.PurchaseItemDetailUID IS NULL&#xA;    AND Purch.PurchaseItemDetailUID IS NULL&#xA;    AND Tags.PurchaseItemDetailUID IS NULL&#xA;&#xA;    UPDATE tblTechPurchaseItemShipments&#xA;    SET QuantityShipped = Tags.c&#xA;    FROM tblTechPurchaseItemShipments&#xA;    JOIN (SELECT COUNT(*) AS c, PurchaseItemShipmentUID&#xA;    FROM tblTechPurchaseInventory&#xA;    GROUP BY PurchaseItemShipmentUID) AS Tags&#xA;    ON Tags.PurchaseItemShipmentUID = tblTechPurchaseItemShipments.PurchaseItemShipmentUID&#xA;    WHERE Tags.c &gt; QuantityShipped&#xA;&#xA;    UPDATE tblTechPurchaseItemShipments&#xA;    SET StatusUID = 33&#xA;    FROM tblTechPurchaseItemShipments&#xA;    JOIN (SELECT COUNT(*) AS c, PurchaseItemShipmentUID&#xA;    FROM tblTechPurchaseInventory&#xA;    GROUP BY PurchaseItemShipmentUID) AS Tags&#xA;    ON Tags.PurchaseItemShipmentUID = tblTechPurchaseItemShipments.PurchaseItemShipmentUID&#xA;    WHERE Tags.c = QuantityShipped&#xA;    AND (StatusUID = 32&#xA;    OR StatusUID = 58)&#xA;&#xA;    UPDATE tblTechPurchaseItemShipments&#xA;    SET StatusUID = 58&#xA;    FROM tblTechPurchaseItemShipments&#xA;    JOIN (SELECT COUNT(*) AS c, PurchaseItemShipmentUID&#xA;    FROM tblTechPurchaseInventory&#xA;    GROUP BY PurchaseItemShipmentUID) AS Tags&#xA;    ON Tags.PurchaseItemShipmentUID = tblTechPurchaseItemShipments.PurchaseItemShipmentUID&#xA;    WHERE Tags.c &lt; QuantityShipped&#xA;    AND StatusUID = 33&#xA;&#xA;    UPDATE tblTechPurchaseItemDetails&#xA;    SET QuantityReceived = TPIS.Quantity&#xA;    FROM tblTechPurchaseItemDetails AS TPID&#xA;    JOIN (SELECT PurchaseItemDetailUID, SUM(QuantityShipped) AS Quantity&#xA;    FROM tblTechPurchaseItemShipments&#xA;    GROUP BY PurchaseItemDetailUID) AS TPIS&#xA;    ON TPID.PurchaseItemDetailUID = TPIS.PurchaseItemDetailUID&#xA;    WHERE TPIS.Quantity &gt; TPID.QuantityReceived&#xA;&#xA;    UPDATE tblTechPurchaseItemDetails&#xA;    SET QuantityOrdered = QuantityReceived&#xA;    WHERE QuantityReceived &gt; QuantityOrdered&#xA;&#xA;    UPDATE tblTechPurchaseItemDetails&#xA;    SET StatusUID = 32&#xA;    WHERE QuantityOrdered &gt; QuantityReceived&#xA;    AND StatusUID = 33&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{1DE60036-6246-471A-8A94-B34AC5AFB791}"
      DTS:From="Package\01 -Manufacturers"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\02 - Areas" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{E1D336BD-2A8F-439D-8333-052E7CE16772}"
      DTS:From="Package\02 - Areas"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\03 - Item Types" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 10]"
      DTS:CreationName=""
      DTS:DTSID="{FD0FF007-8671-4917-AC59-7A83BBD1C06D}"
      DTS:From="Package\11 - Inventory ItemUID"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 10"
      DTS:To="Package\12 - Inventory Purchase Details" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 11]"
      DTS:CreationName=""
      DTS:DTSID="{53136CA3-95BF-48F4-8A09-EEFE176137B0}"
      DTS:From="Package\13 - Purchase Details - Opt 17"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 11"
      DTS:To="Package\14 - Inventory Update" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 12]"
      DTS:CreationName=""
      DTS:DTSID="{A7F55201-A3E3-4286-A8A8-9F71EE9DEA1C}"
      DTS:From="Package\14 - Inventory Update"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 12"
      DTS:To="Package\14 - Custom Fields Update - Opt 7-14" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 13]"
      DTS:CreationName=""
      DTS:DTSID="{600849ED-60D3-4C05-A72A-97FFF2D9B934}"
      DTS:From="Package\14 - Custom Fields Update - Opt 7-14"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 13"
      DTS:To="Package\15 - Inventory Insert" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 14]"
      DTS:CreationName=""
      DTS:DTSID="{34321516-7041-424D-836A-0A1BC888D9BB}"
      DTS:From="Package\15 - Inventory Insert"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 14"
      DTS:To="Package\16 -Custom Field Insert- Opt 7-14 - Not Used" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 15]"
      DTS:CreationName=""
      DTS:DTSID="{402EA497-71C8-442E-A551-C02DCD316AA2}"
      DTS:From="Package\16 -Custom Field Insert- Opt 7-14 - Not Used"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 15"
      DTS:To="Package\17 - Inventory Purchase Details Update" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 16]"
      DTS:CreationName=""
      DTS:DTSID="{AE96646D-2522-4837-987B-47E623262757}"
      DTS:From="Package\12 - Inventory Purchase Details"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 16"
      DTS:To="Package\17 -Purchase Items- Opt 1 - Not Used" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 18]"
      DTS:CreationName=""
      DTS:DTSID="{12FAC1B1-AF5C-427C-B768-DF3348C0E8D8}"
      DTS:From="Package\17 - Inventory Purchase Details Update"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 18"
      DTS:To="Package\20 - Inventory Purchase Details Insert - Opt 17" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 19]"
      DTS:CreationName=""
      DTS:DTSID="{1E923E77-0D31-4AD1-99CD-5BBE5B34CCE9}"
      DTS:From="Package\20 - Inventory Purchase Details Insert - Opt 17"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 19"
      DTS:To="Package\21 -Purchase Shipments - Not Used" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{16ADEFDC-EE53-4884-967F-E05B6DD69DC4}"
      DTS:From="Package\03 - Item Types"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\04 - Items - Opt 1 &amp; 2" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 20]"
      DTS:CreationName=""
      DTS:DTSID="{3791B8E6-78D2-4EBC-BA0E-3905105ACFE3}"
      DTS:From="Package\22 -Inventory Purchase Shipments Update"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 20"
      DTS:To="Package\23 -Inventory Purchase Shipments Insert" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 21]"
      DTS:CreationName=""
      DTS:DTSID="{A71C30CF-C30A-4A13-82DA-9FC78BD83F00}"
      DTS:From="Package\21 -Purchase Shipments - Not Used"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 21"
      DTS:To="Package\22 -Inventory Purchase Shipments Update" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 22]"
      DTS:CreationName=""
      DTS:DTSID="{722A8FC2-E725-49BB-BAF0-C3450F013990}"
      DTS:From="Package\23 -Inventory Purchase Shipments Insert"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 22"
      DTS:To="Package\24 - Inventory Purchase Inventory Update" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 23]"
      DTS:CreationName=""
      DTS:DTSID="{D288E068-8E2B-4187-8399-D396A1BFC1AF}"
      DTS:From="Package\24 - Inventory Purchase Inventory Update"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 23"
      DTS:To="Package\25 - Inventory Purchasing Inventory Insert" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 24]"
      DTS:CreationName=""
      DTS:DTSID="{908EB4C4-8C26-441A-A96A-A39970BE67B1}"
      DTS:From="Package\00 -Default Room &amp; ETL Items - Opt 4, 19, &amp; 20"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 24"
      DTS:To="Package\01 -Manufacturers" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 25]"
      DTS:CreationName=""
      DTS:DTSID="{08A2234C-AAC7-4B11-8BC0-E6D17838556A}"
      DTS:From="Package\08 -Create Purchase Orders Update ETL Purchases"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 25"
      DTS:To="Package\09 - Locations - Opt 3" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{E787BF39-8AE0-4882-81B5-9C1F7F77DEF5}"
      DTS:From="Package\04 - Items - Opt 1 &amp; 2"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\05 -Populate _ETL_Purchases" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{C7B5D738-7EB7-4494-8038-6987E32681DE}"
      DTS:From="Package\05 -Populate _ETL_Purchases"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\06 -Purchase Vendors" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 5]"
      DTS:CreationName=""
      DTS:DTSID="{5637BD9C-DBB7-40A4-9519-E594E1BBEA96}"
      DTS:From="Package\06 -Purchase Vendors"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 5"
      DTS:To="Package\07 -Purchase &amp; Inventory Funding Sources -" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 6]"
      DTS:CreationName=""
      DTS:DTSID="{000CFB47-A7FE-4798-B3D5-645719CA23BD}"
      DTS:From="Package\07 -Purchase &amp; Inventory Funding Sources -"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 6"
      DTS:To="Package\08 -Create Purchase Orders Update ETL Purchases" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 7]"
      DTS:CreationName=""
      DTS:DTSID="{7599F7FD-6F5C-4A43-BC26-FCE68BC07365}"
      DTS:From="Package\09 - Locations - Opt 3"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 7"
      DTS:To="Package\10 - Status &amp; Dept - Opt 5" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 8]"
      DTS:CreationName=""
      DTS:DTSID="{5AEA837D-8367-470E-85B6-CC2BABDA5834}"
      DTS:From="Package\10 - Status &amp; Dept - Opt 5"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 8"
      DTS:To="Package\11 - Inventory ItemUID" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 9]"
      DTS:CreationName=""
      DTS:DTSID="{17356EAE-AE25-41DB-8711-2EF2854EC8A8}"
      DTS:From="Package\17 -Purchase Items- Opt 1 - Not Used"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 9"
      DTS:To="Package\13 - Purchase Details - Opt 17" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="sql12">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="64" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssge="clr-namespace:Microsoft.SqlServer.Graph.Extended;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
        <NodeLayout
          Size="244,42"
          Id="Package\00 -Default Room &amp; ETL Items - Opt 4, 19, &amp; 20"
          TopLeft="156.820754716981,76.9528301886793" />
        <NodeLayout
          Size="164,44"
          Id="Package\01 -Manufacturers"
          TopLeft="148.5,159.877358490566" />
        <NodeLayout
          Size="164,44"
          Id="Package\02 - Areas"
          TopLeft="372.952830188679,163.877358490566" />
        <NodeLayout
          Size="164,44"
          Id="Package\03 - Item Types"
          TopLeft="596.405660377359,166.877358490566" />
        <NodeLayout
          Size="186,42"
          Id="Package\04 - Items - Opt 1 &amp; 2"
          TopLeft="816.858490566038,162.877358490566" />
        <NodeLayout
          Size="197,51"
          Id="Package\05 -Populate _ETL_Purchases"
          TopLeft="1047.31132075472,156.141509433962" />
        <NodeLayout
          Size="164,44"
          Id="Package\06 -Purchase Vendors"
          TopLeft="1297.31132075472,164.877358490566" />
        <NodeLayout
          Size="207,44"
          Id="Package\07 -Purchase &amp; Inventory Funding Sources -"
          TopLeft="143.85849056604,250.141509433962" />
        <NodeLayout
          Size="233,42"
          Id="Package\08 -Create Purchase Orders Update ETL Purchases"
          TopLeft="389,255" />
        <NodeLayout
          Size="184,42"
          Id="Package\09 - Locations - Opt 3"
          TopLeft="671.405660377359,257.141509433962" />
        <NodeLayout
          Size="205,42"
          Id="Package\10 - Status &amp; Dept - Opt 5"
          TopLeft="898.952830188679,255.141509433962" />
        <NodeLayout
          Size="191,44"
          Id="Package\11 - Inventory ItemUID"
          TopLeft="1135.95283018868,255.330188679245" />
        <NodeLayout
          Size="244,49"
          Id="Package\12 - Inventory Purchase Details"
          TopLeft="88.5,351.330188679245" />
        <NodeLayout
          Size="277,42"
          Id="Package\13 - Purchase Details - Opt 17"
          TopLeft="697.405660377359,365.745283018868" />
        <NodeLayout
          Size="258,42"
          Id="Package\14 - Custom Fields Update - Opt 7-14"
          TopLeft="1234.85849056604,365.330188679245" />
        <NodeLayout
          Size="185,42"
          Id="Package\14 - Inventory Update"
          TopLeft="1004.40566037736,363.330188679245" />
        <NodeLayout
          Size="164,44"
          Id="Package\15 - Inventory Insert"
          TopLeft="142.311320754717,466.330188679245" />
        <NodeLayout
          Size="253,46"
          Id="Package\16 -Custom Field Insert- Opt 7-14 - Not Used"
          TopLeft="384.31132075472,463.745283018868" />
        <NodeLayout
          Size="281,42"
          Id="Package\17 - Inventory Purchase Details Update"
          TopLeft="685.952830188679,468.745283018868" />
        <NodeLayout
          Size="260,42"
          Id="Package\17 -Purchase Items- Opt 1 - Not Used"
          TopLeft="386.85849056604,360.745283018868" />
        <NodeLayout
          Size="303,42"
          Id="Package\20 - Inventory Purchase Details Insert - Opt 17"
          TopLeft="1064.5,477.745283018868" />
        <NodeLayout
          Size="258,52"
          Id="Package\21 -Purchase Shipments - Not Used"
          TopLeft="131.5,582.858490566038" />
        <NodeLayout
          Size="289,53"
          Id="Package\22 -Inventory Purchase Shipments Update"
          TopLeft="446.952830188679,579.820754716981" />
        <NodeLayout
          Size="283,56"
          Id="Package\23 -Inventory Purchase Shipments Insert"
          TopLeft="787.405660377359,582.858490566038" />
        <NodeLayout
          Size="228,42"
          Id="Package\24 - Inventory Purchase Inventory Update"
          TopLeft="230.85849056604,703.858490566038" />
        <NodeLayout
          Size="207,52"
          Id="Package\25 - Inventory Purchasing Inventory Insert"
          TopLeft="623.31132075472,703.858490566038" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="312.5,183.877358490566">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="60.4528301886789,0"
              Start="0,0"
              End="52.9528301886789,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="52.9528301886789,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="536.952830188679,187.377358490566">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="59.4528301886801,0"
              Start="0,0"
              End="51.9528301886801,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="51.9528301886801,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 10]"
          TopLeft="1231.45283018868,299.330188679245">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-1020.95283018868,52"
              Start="0,0"
              End="-1020.95283018868,44.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,22" />
                  <mssgle:CubicBezierSegment
                    Point1="0,22"
                    Point2="0,26"
                    Point3="-4,26" />
                  <mssgle:LineSegment
                    End="-1016.95283018868,26" />
                  <mssgle:CubicBezierSegment
                    Point1="-1016.95283018868,26"
                    Point2="-1020.95283018868,26"
                    Point3="-1020.95283018868,30" />
                  <mssgle:LineSegment
                    End="-1020.95283018868,44.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 11]"
          TopLeft="974.405660377359,385.537735849057">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="30,0"
              Start="0,0"
              End="22.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="22.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 12]"
          TopLeft="1189.40566037736,385.330188679245">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="45.452830188681,0"
              Start="0,0"
              End="37.952830188681,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="37.952830188681,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 13]"
          TopLeft="1363.85849056604,407.330188679245">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-1139.54716981132,59"
              Start="0,0"
              End="-1139.54716981132,51.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,25.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,25.5"
                    Point2="0,29.5"
                    Point3="-4,29.5" />
                  <mssgle:LineSegment
                    End="-1135.54716981132,29.5" />
                  <mssgle:CubicBezierSegment
                    Point1="-1135.54716981132,29.5"
                    Point2="-1139.54716981132,29.5"
                    Point3="-1139.54716981132,33.5" />
                  <mssgle:LineSegment
                    End="-1139.54716981132,51.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 14]"
          TopLeft="306.311320754717,487.537735849057">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="78.0000000000031,0"
              Start="0,0"
              End="70.5000000000031,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="70.5000000000031,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 15]"
          TopLeft="637.31132075472,488.245283018868">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="48.6415094339588,0"
              Start="0,0"
              End="41.1415094339588,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="41.1415094339588,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 16]"
          TopLeft="332.5,378.787735849057">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="54.35849056604,0"
              Start="0,0"
              End="46.85849056604,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="46.85849056604,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 18]"
          TopLeft="966.952830188679,489.745283018868">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="97.5471698113211,9"
              Start="0,0"
              End="90.0471698113211,9">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="44.7735849056605,0" />
                  <mssgle:CubicBezierSegment
                    Point1="44.7735849056605,0"
                    Point2="48.7735849056605,0"
                    Point3="48.7735849056605,4" />
                  <mssgle:LineSegment
                    End="48.7735849056605,5" />
                  <mssgle:CubicBezierSegment
                    Point1="48.7735849056605,5"
                    Point2="48.7735849056605,9"
                    Point3="52.7735849056605,9" />
                  <mssgle:LineSegment
                    End="90.0471698113211,9" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 19]"
          TopLeft="1216,519.745283018868">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-955.5,63.11320754717"
              Start="0,0"
              End="-955.5,55.61320754717">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,27.556603773585" />
                  <mssgle:CubicBezierSegment
                    Point1="0,27.556603773585"
                    Point2="0,31.556603773585"
                    Point3="-4,31.556603773585" />
                  <mssgle:LineSegment
                    End="-951.5,31.556603773585" />
                  <mssgle:CubicBezierSegment
                    Point1="-951.5,31.556603773585"
                    Point2="-955.5,31.556603773585"
                    Point3="-955.5,35.556603773585" />
                  <mssgle:LineSegment
                    End="-955.5,55.61320754717" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="760.405660377359,186.377358490566">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="56.4528301886789,0"
              Start="0,0"
              End="48.9528301886789,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="48.9528301886789,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 20]"
          TopLeft="735.952830188679,608.58962264151">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="51.4528301886801,0"
              Start="0,0"
              End="43.9528301886801,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="43.9528301886801,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 21]"
          TopLeft="389.5,607.58962264151">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="57.4528301886789,0"
              Start="0,0"
              End="49.9528301886789,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="49.9528301886789,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 22]"
          TopLeft="928.905660377359,638.858490566038">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-584.047169811319,65"
              Start="0,0"
              End="-584.047169811319,57.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,28.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,28.5"
                    Point2="0,32.5"
                    Point3="-4,32.5" />
                  <mssgle:LineSegment
                    End="-580.047169811319,32.5" />
                  <mssgle:CubicBezierSegment
                    Point1="-580.047169811319,32.5"
                    Point2="-584.047169811319,32.5"
                    Point3="-584.047169811319,36.5" />
                  <mssgle:LineSegment
                    End="-584.047169811319,57.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 23]"
          TopLeft="458.85849056604,727.358490566038">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="164.45283018868,0"
              Start="0,0"
              End="156.95283018868,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="156.95283018868,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 24]"
          TopLeft="278.820754716981,118.952830188679">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-48.320754716981,40.9245283018867"
              Start="0,0"
              End="-48.320754716981,33.4245283018867">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.4622641509433" />
                  <mssgle:CubicBezierSegment
                    Point1="0,16.4622641509433"
                    Point2="0,20.4622641509433"
                    Point3="-4,20.4622641509433" />
                  <mssgle:LineSegment
                    End="-44.320754716981,20.4622641509433" />
                  <mssgle:CubicBezierSegment
                    Point1="-44.320754716981,20.4622641509433"
                    Point2="-48.320754716981,20.4622641509433"
                    Point3="-48.320754716981,24.4622641509433" />
                  <mssgle:LineSegment
                    End="-48.320754716981,33.4245283018867" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 25]"
          TopLeft="622,277.070754716981">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="49.405660377359,0"
              Start="0,0"
              End="41.905660377359,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="41.905660377359,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="1002.85849056604,182.759433962264">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="44.4528301886821,0"
              Start="0,0"
              End="36.9528301886821,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="36.9528301886821,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="1244.31132075472,184.259433962264">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="53,0"
              Start="0,0"
              End="45.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="45.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 5]"
          TopLeft="1379.31132075472,208.877358490566">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-1131.95283018868,41.264150943396"
              Start="0,0"
              End="-1131.95283018868,33.764150943396">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.632075471698" />
                  <mssgle:CubicBezierSegment
                    Point1="0,16.632075471698"
                    Point2="0,20.632075471698"
                    Point3="-4,20.632075471698" />
                  <mssgle:LineSegment
                    End="-1127.95283018868,20.632075471698" />
                  <mssgle:CubicBezierSegment
                    Point1="-1127.95283018868,20.632075471698"
                    Point2="-1131.95283018868,20.632075471698"
                    Point3="-1131.95283018868,24.632075471698" />
                  <mssgle:LineSegment
                    End="-1131.95283018868,33.764150943396" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 6]"
          TopLeft="350.85849056604,274.070754716981">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="38.14150943396,0"
              Start="0,0"
              End="30.64150943396,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="30.64150943396,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 7]"
          TopLeft="855.405660377359,277.141509433962">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="43.5471698113199,0"
              Start="0,0"
              End="36.0471698113199,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="36.0471698113199,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 8]"
          TopLeft="1103.95283018868,276.735849056604">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="32,0"
              Start="0,0"
              End="24.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="24.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 9]"
          TopLeft="646.85849056604,384.245283018868">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="50.547169811319,0"
              Start="0,0"
              End="43.047169811319,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="43.047169811319,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <AnnotationLayout
          Text="Asset = 00, 01, 02, 03, 04, 08, 09, 10, 11, 12, 13, 14, 15, 16, 19, 20, 22, 23, 24, 25"
          ParentId="Package"
          Size="450,40"
          Id="18ba06ec-dd4e-450d-a2be-6cf3738f407c"
          TopLeft="454.292452830189,60.5">
          <AnnotationLayout.FontInfo>
            <mssge:FontInfo
              Family="Tahoma"
              Size="11.25"
              Color="#FF080000">
              <mssge:FontInfo.TextDecorations>
                <av:TextDecorationCollection />
              </mssge:FontInfo.TextDecorations>
            </mssge:FontInfo>
          </AnnotationLayout.FontInfo>
        </AnnotationLayout>
        <AnnotationLayout
          Text="b"
          ParentId="Package"
          FontInfo="{assembly:Null}"
          Size="38,42"
          Id="c4934f7f-d080-4b61-b3e1-fc203fad37ef"
          TopLeft="3199,275" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>