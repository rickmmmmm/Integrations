<?xml version="1.0" encoding="utf-8"?>
<SharedDataSet xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/shareddatasetdefinition">
  <Description />
  <DataSet Name="DupProducts">
    <Query>
      <DataSourceReference>HayesConversion</DataSourceReference>
      <CommandText>IF OBJECT_ID(N'tempdb..#dupProduct') IS NOT NULL BEGIN DROP TABLE #dupProduct END 
SELECT        MAX(id) maxid, ProductName
                                                                                                                                                                                                        INTO               #dupProduct
                                                                                                                                                                                                        FROM            (SELECT        ROW_NUMBER() OVER (PARTITION BY 
                                                                                                                                                                                                                                                            productname
                                                                                                                                                                                                                                  ORDER BY Productname) id, *
                                                                                                                                                                                                        FROM            (SELECT DISTINCT 
                                                                                                                                                                                                                                                            /*-DISTINCT ROW_NUMBER() OVER (PARTITION BY ast.product ORDER BY ast.Product)id,*/ ast.ProductName,
                                                                                                                                                                                                                                                             ItemTypeName, ModelNumber, 
                                                                                                                                                                                                                                                            ManufacturerName
                                                                                                                                                                                                                                  /*,vendorname*/ FROM Clients_ETL ast JOIN
                                                                                                                                                                                                                                                                (SELECT DISTINCT 
                                                                                                                                                                                                                                                                                            ast.ProductName, COUNT(ast.ProductName) 
                                                                                                                                                                                                                                                                                            AS dupProduct
                                                                                                                                                                                                                                                                  FROM            Clients_ETL ast
                                                                                                                                                                                                                                                                  /*WHERE Product = '1.86PROC.GHZ 4GBMEM. 120GB HD'*/ GROUP
                                                                                                                                                                                                                                                                                             BY ast.ProductName
                                                                                                                                                                                                                                                                  HAVING         count(ast.ProductName) &gt; 1) a ON 
                                                                                                                                                                                                                                                            ast.ProductName = a.ProductName) b) c
GROUP BY ProductName
HAVING        MAX(Id) &gt; 1
ORDER BY ProductName
                             SELECT DISTINCT 
                                                       ast.ProductName, ast.ItemTypeName, ast.ModelNumber, ast.ManufacturerName, ItemSuggestedPrice, DepartmentName, SKU, serial_required, 
                                                       ProjectedLife, ProductInfo1, ProductInfo2, ProductInfo3
                              /*, ast.vendorname*/ FROM #dupProduct dup JOIN
                                                       Clients_ETL ast ON dup.ProductName = ast.ProductName
                              ORDER BY ProductName</CommandText>
      <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
    </Query>
    <Fields>
      <Field Name="ProductName">
        <DataField>ProductName</DataField>
        <rd:TypeName>System.String</rd:TypeName>
      </Field>
      <Field Name="ItemTypeName">
        <DataField>ItemTypeName</DataField>
        <rd:TypeName>System.String</rd:TypeName>
      </Field>
      <Field Name="ModelNumber">
        <DataField>ModelNumber</DataField>
        <rd:TypeName>System.String</rd:TypeName>
      </Field>
      <Field Name="ManufacturerName">
        <DataField>ManufacturerName</DataField>
        <rd:TypeName>System.String</rd:TypeName>
      </Field>
      <Field Name="ItemSuggestedPrice">
        <DataField>ItemSuggestedPrice</DataField>
        <rd:TypeName>System.String</rd:TypeName>
      </Field>
      <Field Name="DepartmentName">
        <DataField>DepartmentName</DataField>
        <rd:TypeName>System.String</rd:TypeName>
      </Field>
      <Field Name="SKU">
        <DataField>SKU</DataField>
        <rd:TypeName>System.String</rd:TypeName>
      </Field>
      <Field Name="serial_required">
        <DataField>serial_required</DataField>
        <rd:TypeName>System.String</rd:TypeName>
      </Field>
      <Field Name="ProjectedLife">
        <DataField>ProjectedLife</DataField>
        <rd:TypeName>System.String</rd:TypeName>
      </Field>
      <Field Name="ProductInfo1">
        <DataField>ProductInfo1</DataField>
        <rd:TypeName>System.String</rd:TypeName>
      </Field>
      <Field Name="ProductInfo2">
        <DataField>ProductInfo2</DataField>
        <rd:TypeName>System.String</rd:TypeName>
      </Field>
      <Field Name="ProductInfo3">
        <DataField>ProductInfo3</DataField>
        <rd:TypeName>System.String</rd:TypeName>
      </Field>
    </Fields>
  </DataSet>
</SharedDataSet>